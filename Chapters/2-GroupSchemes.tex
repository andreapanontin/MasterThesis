\documentclass[../Main]{subfiles}
\begin{document}
\section{Group schemes}
In this section we introduce the notion of {\em group object}
in a category, stating all of the results in the category
of $S$-schemes, for a fixed scheme $S$.
We will then state a few results which will play an important role
in what follows.


\begin{defn}[$S$-Group scheme]
	Let $F\colon \mathsf{Sch}_S^{op} \to \mathsf{Gp}$ be a functor.
	Assume that $F$ is representable by $G \in \mathsf{Sch}_{ S }$, i.e. such that, 
	functorially in $T \in \mathsf{Sch}_{ S }$,
	\begin{equation*}
		\iota F(T) \simeq \mathrm{Hom}_{\mathsf{Sch}_S} \left( T, G \right)
	,\end{equation*} 
	for $\iota\colon \mathsf{Gp} \to \mathsf{Sets}$ the forgetful functor.
	Then we call $G$ a {\em group scheme} over $S$
	or $S$-group scheme.
\end{defn}


\begin{rem}[$T$-points of an $S$-scheme]
	Let's recall the standard notation: let $T \in \mathsf{Sch}_{ S }$, one defines
	the $T$-points of $G \in \mathsf{Sch}_{ S }$ as
	\begin{equation*}
		G(T) \coloneqq \mathrm{Hom}_{\mathsf{Sch}_{ S }} \left( T, G \right)
	.\end{equation*} 
	If, in particular, $G$ is a {\em group scheme} then, by definition,
	$G(T)$ is endowed with group structure for every $T \in \mathsf{Sch}_{ S }$.
\end{rem}


\begin{rem}[]
	By definition, a group is a set $G \in \mathsf{Sets}$, endowed with an operation,
	an inverse map, and an identity element satisfying the usual properties.
	These can be rewritten in terms of commutative diagrams.
	At first one writes the above three (respectively) as the following maps:
	\begin{equation*}
			\begin{tikzcd}[row sep = 0ex
         ,/tikz/column 1/.append style={anchor=base east}
         ,/tikz/column 2/.append style={anchor=base west}
         ,/tikz/column 3/.append style={anchor=base east}]
			m\colon G \cross G \arrow[r, "", rightarrow] &
			G & \text{(multiplication)} \\
			\mathrm{inv}\colon G \arrow[r, "", rightarrow] &
			G & \text{(inverse)} \\
			\varepsilon \colon \left\{ e \right\} \arrow[r, "", rightarrow] &
			G & \text{(unit)} 
		\end{tikzcd}
	\end{equation*} 
	for $\left\{ e \right\}$ the terminal object in $\mathsf{Gp}$.
	Let's write $\pi\colon G \to \left\{ e \right\}$
	as the unique arrow in the terminal object of $\mathsf{Gp}$
	and $\Delta\colon G \to G \cross G$ the diagonal morphism.
	Then, associativity of product, inverse element and
	identity are characterized by: 
	\begin{align}\label{eq:GroupAxioms}
		m \circ (id_G \cross m) &= m \circ (m \cross id_G),\nonumber\\
		m \circ (id_G \cross \mathrm{inv}) \circ \Delta &=
		m \circ (\mathrm{inv} \cross id_G) \circ \Delta = \varepsilon \circ \pi,\\
		m \circ (\varepsilon \cross id_G) &=
		m \circ (id_G \cross \varepsilon) = id_G\nonumber
	.\end{align} 
	Notice that in this last equality we implicitly use the isomorphism
	$\left\{ e \right\} \cross G \simeq G \simeq G \cross \left\{ e \right\}$.
\end{rem}


\begin{rem}[]\label{rem:StructuralMorphisms}
	Given a group scheme $G \in \mathsf{Sch}_{ S }$, Yoneda's lemma allows to translate
	the group structure of $G(T)$, for $T \in \mathsf{Sch}_{ S }$, into a group structure on $G$.
	In fact, since the universal property of
	fibered product gives $\left( G \cross_{ S } G \right)(T) = G(T) \cross G(T)$,
	one obtains that there exist unique maps
	\begin{equation*}
			\begin{tikzcd}[row sep = 0ex
         ,/tikz/column 1/.append style={anchor=base east}
         ,/tikz/column 2/.append style={anchor=base west}
         ,/tikz/column 3/.append style={anchor=base east}]
			m\colon G \cross_{ S } G \arrow[r, "", rightarrow] &
			G & \text{(multiplication)} \\
			\mathrm{inv}\colon G \arrow[r, "", rightarrow] &
			G & \text{(inverse)} \\
			\varepsilon \colon S \arrow[r, "", rightarrow] &
			G & \text{(unit)} 
		\end{tikzcd}
	\end{equation*} 
	inducing the group structure on $G(T)$ via Yoneda embedding.
	Then, again by Yoneda's lemma, also the above maps have to
	satisfy the properties written in 
	\cref{eq:GroupAxioms}.
	More explicitly:
	\begin{enumerate}
		\item Associativity of the product
			\begin{equation*}
			\begin{tikzcd}[column sep=4.5em]
				G \cross_{ S } G \cross_{ S } G 
				\arrow[r, "id_G \cross_S m", rightarrow] 
				\arrow[d, "m \cross_S id_G"', rightarrow] &
				G \cross_{ S } G \arrow[d, "m", rightarrow] \\
				G \cross_{ S } G \arrow[r, "m"', rightarrow] &
				G.
			\end{tikzcd}
			\end{equation*} 
		\item Inverse morphism 
			\begin{equation*}
			\begin{tikzcd}[column sep=2.7em]
				G \cross_{ S } G \arrow[rr, "id_G \cross_S \mathrm{inv}", rightarrow] & &
				G \cross_{ S } G \arrow[d, "m", rightarrow] \\
				G \arrow[u, "\Delta", rightarrow] 
				\arrow[r, "\pi", rightarrow] &
				S \arrow[r, "\varepsilon", rightarrow] & 
				G
			\end{tikzcd}
			\qquad
			\begin{tikzcd}[column sep=2.7em]
				G \cross_{ S } G \arrow[rr, "\mathrm{inv} \cross_S id_G", rightarrow] & &
				G \cross_{ S } G \arrow[d, "m", rightarrow] \\
				G \arrow[u, "\Delta", rightarrow] 
				\arrow[r, "\pi", rightarrow] &
				S \arrow[r, "\varepsilon", rightarrow] & 
				G
			\end{tikzcd}
			\end{equation*} 
		\item Identity element (again, as with groups, in the following diagrams
			we will implicitly use the iso
			$S \cross_{ S } G \simeq G \simeq G \cross_{ S } S$)
			\begin{equation*}
			\begin{tikzcd}
				G \cross_{ S } G \arrow[r, "m", rightarrow] &
				G \\
				S \cross_{ S } G \arrow[r, "id_G", rightarrow] 
				\arrow[u, "\varepsilon \cross_S id_G", rightarrow] &
				G \arrow[u, "id_G"', rightarrow] 
			\end{tikzcd}
			\qquad
			\begin{tikzcd}
				G \cross_{ S } G \arrow[r, "m", rightarrow] &
				G \\
				G \cross_{ S } S \arrow[r, "id_G", rightarrow] 
				\arrow[u, "id_G \cross_S \varepsilon", rightarrow] &
				G. \arrow[u, "id_G"', rightarrow] 
			\end{tikzcd}
			\end{equation*} 
	\end{enumerate}
\end{rem}


\begin{defn}[Commutative $S$-group scheme]
	We say that a group scheme $G \in \mathsf{Sch}_{ S }$ is {\em commutative}
	iff $G(T)$ is an abelian group for all $T \in \mathsf{Sch}_{ S }$.
	Arguing with Yoneda as before,
	this is equivalent to asking that the following diagram commutes
	\begin{equation*}
	\begin{tikzcd}
		G \cross_S G \arrow[rr, "{ \left(\mathrm{pr}_2, \mathrm{pr}_1\right)}", rightarrow] 
		\arrow[rd, "m"', rightarrow] & &
		G \cross_{ S } G
		\arrow[ld, "m", rightarrow] \\
					     &
		G
	.\end{tikzcd}
	\end{equation*}
\end{defn}


\begin{rem}[]
	One can generalize the definition of group object, from the category
	of $S$-schemes, to any category $\mathsf{C}$ admitting finite products
	(hence with final object given by the empty product) in the same manner as above.
	In fact, being $S$ the final object in $\mathsf{Sch}_{ S }$, one sees
	that fibered products over $S$ (seen in the category of schemes)
	are just products in $\mathsf{Sch}_{ S }$.
\end{rem}


\begin{defn}[Morphism of group schemes]
	Let $G, G'$ be group schemes, a {\em homomorphism of group schemes}
	\begin{equation*}
		\begin{tikzcd}
			\alpha\colon G \arrow[r, "", rightarrow] &
			G'
		\end{tikzcd}
	\end{equation*} 
	is a morphism $G \to G'$ in $\mathsf{Sch}_{ S }$ s.t., for all
	$T \in \mathsf{Sch}_{ S }$, the corresponding morphism at the level of $T$-points
	is a group homomorphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\alpha(T)\colon G(T) \arrow[r, "", rightarrow] &
		G'(T) \\
		g \arrow[r, "", mapsto] & \alpha \circ g.
	\end{tikzcd}
	\end{equation*} 
	Notice that the identity of a group scheme is clearly a homomorphism of group
	schemes and compositions of group schemes homomorphisms are still
	group scheme homomorphisms.
\end{defn}


\begin{rem}
	Let $G, G'$ be group schemes, representing the functors $F,F'$.
	Then, by Yoneda's lemma, giving a homomorphism $\alpha\colon G \to G'$
	is equivalent to giving a morphism between the functors they represent.

	Again by Yoneda's lemma, one sees that a morphism $\alpha\colon G \to G'$
	in $\mathsf{Sch}_{ S }$ is a morphism of group schemes iff
	it preserves products, i.e. iff
	\begin{equation*}
		\alpha \circ m = m' \circ (\alpha, \alpha)
	,\end{equation*} 
	for $m, m'$ the product morphisms of $G$ and $G'$ respectively.
\end{rem}


\begin{defn}[Category of $S$-group schemes]
	Hence, combining all of the definitions so far, 
	one can define $\mathsf{Gp}_S$, the subcategory of $\mathsf{Sch}_{ S }$,
	of {\em $S$-group schemes}, or more simply {\em $S$-groups},
	whose objects are $S$-group schemes
	and morphisms are homomorphisms of $S$-group schemes.
\end{defn}


\begin{rem}[Kernels and cokernels]
	As with any category, one can define kernels and cokernels 
	in $\mathsf{Gp}_S$ via the usual universal properties.
	With regards to kernels, one can easily check that, given a morphism
	$\alpha\colon G \to G'$ of $S$-groups, then 
	\begin{equation*}
	\begin{tikzcd}
		G \cross_{ G' } S \arrow[r, "i", rightarrow] &
		G,
	\end{tikzcd}
	\end{equation*} 
	where $i$ is the projection on the first factor, is a kernel for $\alpha$.
	Hence kernels exist in $\mathsf{Gp}_S$.
	
	When it comes to cokernels, instead, one finds difficulties, much like
	with sheaves of abelian groups.
	In fact, given a morphism $\alpha\colon G \to G'$, one cannot always find an
	element $H \in \mathsf{Gp}_S$ representing the functor
	\begin{equation*}
	\begin{tikzcd}
		T \arrow[r, "", mapsto] &
		\coker (\alpha_T) =
		G(T)/G'(T).
	\end{tikzcd}
	\end{equation*}
\end{rem}


\subsection{Affine group schemes}
The above definitions have a dual interpretation in the affine case,
which we want to show in this section.
Moreover, in the following, we will mostly concentrate on affine
group schemes, hence in the rest of the discussion about group schemes
we will concentrate on them, even though most of the
results can be proved in a more general setting.


\begin{rem}[]
If we assume that $G = \mathrm{Spec}(A)$ is affine, 
the arrow-reversing equivalence of categories between
affine $R$-schemes and commutative $R$-algebras, 
allows us to translate the structural morphisms
of schemes defined in \cref{rem:StructuralMorphisms} into
appropriate $R$-algebra morphisms.
Then the properties defined by the diagrams in \cref{rem:StructuralMorphisms}
will translate into properties for these new morphisms.

Recall that the structural morphism $\pi\colon G \to S$ corresponds to a
morphism $R \to A$ making $A$ into an $R$-algebra.
Moreover the diagonal morphism $\Delta\colon G \to G \cross_{ S } G$ corresponds
to the multiplication morphism of the $R$-algebra $A$:
\begin{equation*}
\begin{tikzcd}[row sep = 0ex
	,/tikz/column 1/.append style={anchor=base east}
	,/tikz/column 2/.append style={anchor=base west}]
	\widetilde{\Delta}\colon A \otimes_R A \arrow[r, "", rightarrow] &
	A \\
	a \otimes_R b \arrow[r, "", mapsto] & a \cdot b
.\end{tikzcd}
\end{equation*} 
With this in mind we obtain the following $3$ $R$-algebra morphisms:
\begin{equation*}
		\begin{tikzcd}[row sep = 0ex
 ,/tikz/column 1/.append style={anchor=base east}
 ,/tikz/column 2/.append style={anchor=base west}
 ,/tikz/column 3/.append style={anchor=base east}]
		\widetilde{m}\colon A \arrow[r, "", rightarrow] &
		A \otimes_R A & \text{(comultiplication)} \\
		\widetilde{\mathrm{inv}}\colon A \arrow[r, "", rightarrow] &
		A & \text{(antipode)} \\
		\widetilde{\varepsilon} \colon A \arrow[r, "", rightarrow] &
		R & \text{(counit/augmentation),}
	\end{tikzcd}
\end{equation*} 
satisfying the duals of the diagrams in \cref{rem:StructuralMorphisms}.
\end{rem}


\begin{defn}[Hopf algebra]\label{defn:HopfAlgebra}
	An {\em Hopf algebra over $R$} is an $R$-algebra $A$,
	endowed with a comultiplication, a couint and an antipode map,
	respectively:
	\begin{equation*}
			\begin{tikzcd}[row sep = 0ex
         ,/tikz/column 1/.append style={anchor=base east}
         ,/tikz/column 2/.append style={anchor=base west}
         ,/tikz/column 3/.append style={anchor=base east}]
			\widetilde{m}\colon A \arrow[r, "", rightarrow] &
			A \otimes_R A \\
			\widetilde{\mathrm{inv}}\colon A \arrow[r, "", rightarrow] &
			A \\
			\widetilde{\varepsilon} \colon A \arrow[r, "", rightarrow] &
			R,
		\end{tikzcd}
	\end{equation*} 
	satisfying the conditions obtained by dualizing those
	of \cref{rem:StructuralMorphisms}, more explicitly:
	\begin{align*}
		( \widetilde{m} \otimes_R id_A ) \circ \widetilde{m} &=
		( id_A \otimes_R \widetilde{m} ) \circ \widetilde{m},\\
		( id_A \otimes_R \widetilde{\varepsilon} ) \circ \widetilde{m} &=
		( \widetilde{\varepsilon} \otimes_R id_A ) \circ \widetilde{m} =
		id_A,\\
		\widetilde{\Delta} \circ ( id_A \otimes_R \widetilde{\mathrm{inv}} ) 
		\circ \widetilde{m} &=
		\widetilde{\Delta} \circ ( \widetilde{\mathrm{inv}} \otimes_R id_A ) 
		\circ \widetilde{m} =
		(R \to A) \circ \widetilde{\varepsilon}
	.\end{align*} 
	Moreover one defines a morphism of Hopf algebras to be an $R$-algebra
	morphism preserving the just defined morphisms.
	Finally we call $I \coloneqq \ker \widetilde{\varepsilon}$ the 
	{\em augmentation ideal} of $A$.
\end{defn}
Actually, as is the case for groups, it is enough to check that an $R$ algebra
morphism commutes with $\widetilde{m}$, in order for it to be a Hopf algebra morphism.


\begin{rem}[Equivalence of categories]
	Clearly, then, any Hopf algebra over $R$ gives rise
	to an affine $R$-group via the aforementioned equivalence of categories.
	This actually is an equivalence of categories between affine
	$R$-group schemes and Hopf algebras over $R$.
	In fact	the multiplication morphism in a group scheme
	corresponds to the comultiplication morphism in its 
	associated Hopf algebra, and morphism in the two categories are defined
	to preserve such operation.
\end{rem}


\begin{defn}[Augmentation ideal]
	For a Hopf algebra $A$ over $R$,
	the structure morphism $R \to A$
	splits the following short exact sequence
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		I \arrow[r, "", rightarrow] &
		A \arrow[r, "\widetilde{\varepsilon}", rightarrow] &
		R \arrow[r, "", rightarrow] &
		0.
	\end{tikzcd}
	\end{equation*}
	Hence we have $A = R \cdot 1 \oplus I$,
	from which we desume that $A \otimes A = R \oplus \left( I \otimes 1 \right) \oplus
	\left( 1 \otimes I \right) \oplus \left( I \otimes I \right)$.
	Finally it is easy to show that, for all $f \in I$,
	\begin{equation*}
		\widetilde{m}(f) - f \otimes 1 - 1 \otimes f \in I \otimes I
	.\end{equation*} 
\end{defn}


For these last results we'll assume that $S$ is a locally Noetherian base scheme.
\begin{rem}[Finite $S$-group]
	An $S$-scheme $G$ is finite and flat over $S$ iff its sheaf of regular functions
	$\mathcal{O}_G$ is locally free of finite rank as an $\mathcal{O}_S$-module.
	More explicitly this means that there exists a cover of $S$ by affine open subschemes
	$V_i$ s.t. for all $i$ the restriction of the structure morphism is of the form
	$\mathrm{Spec}(A) \to \mathrm{Spec}(R)$, for $A$ a free $R$-module of finite rank over $R$. 
	This is going to our main interest what follows.

	It is also true that finite flat group schemes over affine schemes
	are themselves affine. 
	We are going to be interested in the case of $S = \mathrm{Spec}(R)$,
	for $R$ the ring of integers of a local field, mainly $\mathbb{Z}_p$,
	and $G$ finite flat over $S$.
	Hence we will mainly concentrate on the affine case in what follows.

	Finally we can notice that, over an affine scheme $S = \mathrm{Spec}(R)$,
	a finite flat scheme is just $\mathrm{Spec}(A)$, for a finite projective
	$R$-module $A$ (see, for instance, 
	\cite[\href{https://stacks.math.columbia.edu/tag/00NX}{Lemma 00NX}]{SP}).
\end{rem}

\begin{defn}[Order of a finite flat $S$-scheme]
	Given a finite flat $S$-group scheme $G$, the rank of $\mathcal{O}_X$ as
	and $\mathcal{O}_S$-module is a locally constant function with respect
	to the Zariski topology, with integer values.
	We call such a function the order of $G$ over $S$ and denote it by $[G:S]$.
	Moreover we'll use the notation $[G:S] = n$ to state that $G$ is finite flat of
	constant rank $n$ over $S$.
\end{defn}

\begin{prop}[\cite{TateMF}, \textsection $3$]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
	\item Consider the morphisms of schemes $X \to Y \to S$, with $[X:Y] = m$.
		Then $X$ is finite and flat over $S$ iff $Y$ is, in which case
		$[X:S] = [X:Y] [Y:S]$ as functions on $Y$.
		
	\item If $[X_i:S] = n_i$ for $i=1,2$, then
		$[X_1 \cross_{ S } X_2 : S] = n_1n_2$.

	\item If $[X:S] = n$, then $[X \cross_{ S } T : T] = n$
		for all $T \in \mathsf{Sch}_{ T }$.
\end{enumerate}
\end{prop}


\subsection{Examples}
In order to compute a few useful examples, let's make explicit the relation between
multiplication in an $S$-group and comultiplication in its associated Hopf algebra over
$R$, for $S = \mathrm{Spec}(R)$.
\begin{rem}\label{rem:ExplicitComult}
	Yoneda tells us that the multiplication map 
	$m\colon G \cross G \to G$ can be expressed
	as the product $\mathrm{pr}_1 \mathrm{pr}_2$
	of the two projection morphisms, using the group law
	on $G(G \cross G)$.
	Then, in the case of affine schemes $S = \mathrm{Spec}(R)$
	and $G = \mathrm{Spec}(A)$, one can translate the above to the corresponding
	Hopf algebra morphism, using the equivalence of categories.
	More explicitly one can describe the comultiplication map
	$\widetilde{m}$ as the product in 
	$\mathrm{Hom}_{R\text{-}\mathsf{Alg}} \left( A, A \otimes_R A \right)$ 
	(which has the same group structure as $G(G \cross G)$)
	of the embedding morphisms
	\begin{equation*}
	\begin{tikzcd}
		\widetilde{\mathrm{pr}}_1: a \arrow[r, "", mapsto] &
		a \otimes_R 1 &
		\text{and} &
		\widetilde{\mathrm{pr}}_2: a \arrow[r, "", mapsto] &
		1 \otimes_R a
	.\end{tikzcd}
	\end{equation*}
\end{rem}


\begin{ex}
	In all of the following examples we will denote $S \coloneqq \mathrm{Spec}(R)$
	and $G \coloneqq \mathrm{Spec}(A)$.\nopagebreak[4]
	\begin{enumerate}
		\item The {\em additive group scheme}, given by 
			$\mathbb{G}_a \coloneqq \mathrm{Spec}(R[x])$.
			It acts on $R$-schemes by
			\begin{equation*}
			\begin{tikzcd}[row sep = 0ex
				,/tikz/column 1/.append style={anchor=base east}
				,/tikz/column 2/.append style={anchor=base west}]
%				\mathbb{G}_a\colon \mathsf{Sch}_{ S } \arrow[r, "", rightarrow] &
%				\mathsf{Gp} \\
				X \arrow[r, "", mapsto] & 
				\Gamma \left( X , \mathcal{O}_{ X } \right)
			,\end{tikzcd}
			\end{equation*} 
			in which $\Gamma \left( X , \mathcal{O}_{ X } \right)$ is viewed
			as an additive group.
		%	Then $\mathbb{G}_a$ is represented by 
		%	\begin{equation*}
		%		G = \mathrm{Spec}(R[x])
		%	.\end{equation*} 
			In fact	we know that
			\begin{equation*}
			\mathrm{Hom}_{\mathsf{Sch}_S} \left( X, \mathbb{G}_a \right) \simeq
			\mathrm{Hom}_{R \text{-}\mathsf{Alg}} 
			\left( R[x], \Gamma \left( X , \mathcal{O}_{ X } \right) \right) \simeq
			\Gamma \left( X , \mathcal{O}_{ X } \right)
			,\end{equation*} 
			functorially in $X$.
			The last isomorphism is determined by 
			$(x \mapsto a) \mapsto a$.
			The hom set 
			$\mathrm{Hom}_{R \text{-}\mathsf{Alg}} \left( R[x], A \right)$
			inherits the additive group structure from $A$, and the embeddings
			of $R[x]$ in $R[x] \otimes_R R[x]$ are given by
			\begin{equation*}
				\widetilde{\mathrm{pr}}_1(x) = x \otimes_R 1
				\qquad \text{ and } \qquad
				\widetilde{\mathrm{pr}}_2(x) = 1 \otimes_R x
			.\end{equation*} 
			Then, thanks to \cref{rem:ExplicitComult},
			we desume that
			\begin{equation*}
				\widetilde{m}(x) =
				\left( \widetilde{\mathrm{pr}}_1(x) \right) +
				\left( \widetilde{\mathrm{pr}}_2(x) \right) =
				x \otimes_R 1 + 1 \otimes_R x
			.\end{equation*} 
			Then, from the properties (see \cref{defn:HopfAlgebra})
			of counit and antipode, one easily checks that 
			\begin{equation*}
				\widetilde{\varepsilon}(x) = 0
				\qquad \text{ and } \qquad
				\widetilde{\mathrm{inv}}(x) = -x
			.\end{equation*} 


		\item The {\em multiplicative group scheme} 
			$\mathbb{G}_m \coloneqq \mathrm{Spec}(R[x,x^{-1}])$.
			It acts on $R$-schemes by
			\begin{equation*}
			\begin{tikzcd}[row sep = 0ex
				,/tikz/column 1/.append style={anchor=base east}
				,/tikz/column 2/.append style={anchor=base west}]
				X \arrow[r, "", mapsto] & 
				\Gamma \left( X , \mathcal{O}_{ X } \right)^*
			,\end{tikzcd}
			\end{equation*} 
			in which $\Gamma \left( X , \mathcal{O}_{ X } \right)^*$ is viewed
			as a multiplicative group.
			In fact one checks that
			\begin{equation*}
			\mathrm{Hom}_{\mathsf{Sch}_S} \left( X, G \right) \simeq
			\mathrm{Hom}_{R \text{-}\mathsf{Alg}} 
			\left( R[x, x^{-1}], \Gamma \left( X , \mathcal{O}_{ X } \right) \right) \simeq
			\Gamma \left( X , \mathcal{O}_{ X } \right)^*
			,\end{equation*} 
			functorially in $X$.
			Then, reasoning as before, one obtains
			\begin{equation*}
				\widetilde{m}(x) =
				\left( \widetilde{\mathrm{pr}}_1(x) \right) \cdot
				\left( \widetilde{\mathrm{pr}}_2(x) \right) =
				(x \otimes_R 1) \cdot (1 \otimes_R x) = 
				x \otimes_R x
			.\end{equation*} 
			Finally, from the properties  of counit and antipode map
			(see \cref{defn:HopfAlgebra}) one desumes
			\begin{equation*}
				\widetilde{\varepsilon}(x) = 1
				\qquad \text{ and } \qquad
				\widetilde{\mathrm{inv}}(x) = x^{-1}
			.\end{equation*} 


		\item The {\em general linear group scheme} $\mathrm{GL}_n \coloneqq 
			\mathrm{Spec}(R[\mathrm{x},\mathrm{y}]/J)$,
			where
			\begin{equation*}
				R[\mathrm{x},\mathrm{y}] \coloneqq
				R[x_{11}, x_{12}, \ldots, x_{nn},
				y_{11}, \ldots, y_{nn}]
			\end{equation*} 
			and $J$ is the ideal generated by the $n^2$ entries of the matrix
			$\left( x_{ij} \right)_{i,j=1}^n \cdot \left( y_{ij} \right)_{i,j=1}^n - I$,
			for $I$ the identity matrix.
			It acts on $R$-schemes by associating to
			$X \in \mathsf{Sch}_{ S }$ the multiplicative group
			$\mathrm{GL}_n(X)$ of invertible $n \cross n$
%			\begin{equation*}
%			\begin{tikzcd}[row sep = 0ex
%				,/tikz/column 1/.append style={anchor=base east}
%				,/tikz/column 2/.append style={anchor=base west}]
%				X \arrow[r, "", mapsto] & \mathrm{GL}_n(X)
%			,\end{tikzcd}
%			\end{equation*} 
			matrices with coefficients in $\Gamma \left( X , \mathcal{O}_{ X } \right)$.
			Let's recall that, in $\mathrm{GL}_n(X)$, the product
			$\left( x_{i,j} \right)_{i,j = 1}^n \cdot 
			\left( y_{i,j} \right)_{i,j = 1}^n$
			is given by $\left( c_{i,j} \right)_{i,j = 1}^n$, where
			\begin{equation*}
			c_{i,j} = \sum_{l=1}^{n} x_{i,l} \cdot y_{l,j}
			.\end{equation*} 
			Then, reasoning as before, we can explicitly write the Hopf algebra maps.
			Indeed they are
			\begin{equation*}
				\widetilde{m}(x_{i,j})_{i,j=1}^n = \sum_{l=1}^{n} x_{i,l} \otimes_R x_{l,j},
				\quad
				\widetilde{\varepsilon}(x_{i,j})_{i,j=1}^n = 1,
				\quad
				\widetilde{\mathrm{inv}}(x_{i,j})_{i,j=1}^n = (y_{i,j})_{i,j=1}^n
			,\end{equation*} 
			where $\left( y_{i,j} \right)_{i,j}$ satisfies 
			$\left( x_{ij} \right)_{i,j=1}^n \cdot \left( y_{ij} \right)_{i,j=1}^n = I$.


		\item The {\em group scheme of $n$-th roots of unity}, denoted by $\mu_n$.
			Is defined to be the kernel of the $n$-th power morphism
			$\mathbb{G}_m \to \mathbb{G}_m$,
			corresponding to the $R$-algebra morphism
			$\mu\colon x \mapsto x^n$.
			Then $\mu_n$ is represented by $\mathrm{Spec}(\coker \mu)$,
			and the morphism $\mu_n \hookrightarrow \mathbb{G}_m$ is given by the projection
			\begin{equation*}
			\begin{tikzcd}
				R[x,x^{-1}] \arrow[r, "", twoheadrightarrow] &
				R[x,x^{-1}] / (x^n - 1)
			,\end{tikzcd}
			\end{equation*}
			which is surjective, finite and flat, making $\mu_n$
			a closed finite flat subgroup scheme of $\mathbb{G}_m$.


		\item The {\em diagonalizable group schemes}. Let $X$ be an ordinary
			commutative group, and denote by $R[X] \coloneqq \bigoplus_{x \in X} Rx$
			its associated group $R$-algebra.
			This is a Hopf algebra, whose structural morphism
			are given, for every $x \in X$, by
			\begin{equation*}
				\widetilde{m}(x) = x \otimes_R x,
				\quad
				\widetilde{\varepsilon}(x) = 1,
				\quad
				\widetilde{\mathrm{inv}}(x) = x^{-1}
			.\end{equation*} 
			The above can be checked directly, since we have
			the identifications, for $G = \mathrm{Spec}(A)$:
			\begin{equation*}
				\left( D(X) \right)(G) \coloneqq
				\mathrm{Hom}_{R \text{-Alg}} \left( R[X], A \right) \simeq
				\mathrm{Hom}_{\mathsf{Ab}} \left( X, A^* \right)
			,\end{equation*} 
			where the last hom set has a natural structure of abelian
			group.
			Then we define the {\em diagonalizable group scheme} $D(X)$
			as the commutative $R$-group $\mathrm{Spec}(R[X])$.

			Two important cases are $\mathbb{G}_m \simeq D(\mathbb{Z})$
			and $\mu_n \simeq D(\mathbb{Z}/n\mathbb{Z})$.
			Moreover, if $X$ is finite, $R[X]$ is a free $R$-module of rank $n$,
			making $D(X)$ commutative, finite and flat over $R$.
			More generally, for $X$ finitely generated, 
			from the structure theorem for finitely generated abelian groups, 
			$X$ is isomorphic to a finite product of cyclic groups.
			Hence $D(X)$ is a finite product of copies of $\mathbb{G}_m$
			and $\mu_n$, for various $n$.
			It is then a closed subgroup scheme of $\mathbb{G}_m^r$, for some $r$,
			which again can be seen as the closed subgroup scheme of diagonal
			matrices of $\mathrm{GL}_r$, explaining the name 
			{\em diagonalizable}.


		\item The {\em constant group scheme}\label{ex:ConstantGroups}.
			Let $R$ be a ring and $\Gamma$ an ordinary, finite commutative group.
			We define $A$ to be the $R$-algebra $R^\Gamma$,
			of functions from $\Gamma$ to $R$.
			A basis for $A$ is given by $\left\{ e_\sigma \right\}_{\sigma \in \Gamma}$,
			for $e_\sigma(\gamma) = \delta_{\gamma,\sigma}$,
			where $\delta$ is the Kronecker delta.
			Defining the following Hopf algebra morphisms
			we see that $A$ represents an $S$-group scheme,
			called the constant group scheme for $\Gamma$,
			which we denote by $\underline{\Gamma}$.
			\begin{equation*}
				\widetilde{m}(e_\rho) \coloneqq
				\sum_{\gamma\tau = \rho}^{} e_\sigma \otimes_R e_\tau, 
				\quad
				\widetilde{\mathrm{inv}}(e_\sigma) \coloneqq e_{\sigma^{-1}}, 
				\quad
				\widetilde{\varepsilon}(e_\sigma) \coloneqq
				\begin{cases}
					1 & \text{if } \sigma = 1 \in \Gamma\\
					0 & \text{otherwise}
				\end{cases}.
			\end{equation*}


		\item The {\em group scheme of $p^r$-th roots of zero},
			if $\mathrm{char}\, R = p$, denoted by $\alpha_{p^r}$. 
			It is defined to be the kernel of the $p^r$-th power
			morphism $\mathbb{G}_a \to \mathbb{G}_a$,
			corresponding to the $R$-algebra morphism
			$\alpha\colon x \mapsto x^{p^r}$.
			Then $\alpha_{p^r}$ is represented by $\mathrm{Spec}(\coker \alpha)$.
			Moreover this is an additive subgroup scheme, since $\mathrm{char}\, R = p$.
			As for $\mu_n$, it is a closed finite flat subgroup scheme of 
			$\mathbb{G}_a$.
	\end{enumerate}
\end{ex}


\begin{rem}[Base change]\leavevmode\vspace{-\baselineskip}
\begin{enumerate}
\item 	Let $U, T \in \mathsf{Sch}_{ S }$ be two $S$-schemes.
	We use the notation $U_T$ for the base change $U \cross_{ S } T$.
	It is important to notice that, for $V \in \mathsf{Sch}_{ T }$, we 
	have $U_T(V) = U(V)$, where in the last expression
	we considered $V$ as an $S$ scheme, by $V \to T \to S$.


\item	In particular the examples we have developed so far 
	can all be given for $\mathbb{Z}$-group schemes.
	Then we will use the notation given in the examples
	to mean the group scheme over $\mathbb{Z}$
	and take their base change when working in $\mathsf{Sch}_{ S }$.
\end{enumerate}
\end{rem}


\subsection{Connected-étale sequence}
\subsubsection{Quotients and exactness}
In order to construct some important short exact sequences
we need to tackle the problem of the construction
of cokernels, hence of quotient groups.
In order to do so we have to start with the concept of group action.

\begin{defn}[Right action]
	Let $H$ be an $S$-group scheme, and take $X \in \mathsf{Sch}_{ S }$.
	A {\em right action} of $H$ on $X$ is a morphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		a\colon X \cross_{ S } H \arrow[r, "", rightarrow] &
		X
	\end{tikzcd}
	\end{equation*} 
	such that, for all $T \in \mathsf{Sch}_{ S }$, the induced map
	$H(T) \cross X(T) \to  X(T)$ is a right action of the
	group $H(T)$ on the set $X(T)$.
	We say that the action is {\em strictly free} iff the morphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		(id, a)\colon X \cross_{ S } H \arrow[r, "", rightarrow] &
		X \cross_{ S } X
	\end{tikzcd}
	\end{equation*} 
	is a closed immersion.
\end{defn}

The next theorem will allow us to construct quotients of
$S$-group schemes over finite, flat closed subgroup schemes.
It actually is a more general result, due to Grothendieck.
\begin{thm}[\cite{TateMF}, \textsection $3.4$]
	Suppose that $H$, finite flat over $S$, acts strictly freely on $X$
	of finite type over $S$ in such a way that every orbit is contained in an affine open set.
	Then there exists $Y \in \mathsf{Sch}_{ S }$ and a morphism $u\colon X \to Y$,
	constant on orbits, such that for every morphism $v\colon X \to Z$ constant on orbits,
	there is a unique morphism $f\colon Y \to Z$ s.t. $v = f \circ u$.
	We denote $Y$ by $X/H$, and notice that $u$ has the following properties:
\begin{enumerate}
	\item $X$ is finite flat over $X/H$ and $[X:(X/H)] = [H:S]$.
		
	\item For every $T \in \mathsf{Sch}_{ S }$, the following map is injective
		\begin{equation*}
		\begin{tikzcd}
			X(T)/H(T) \arrow[r, "", rightarrowtail] &
			(X/H)(T)
		.\end{tikzcd}
		\end{equation*}
\end{enumerate}
\end{thm}


As promised we obtain the following result for quotient group schemes.
\begin{prop}[\cite{TateMF}, \textsection $3.5$]\label{thm:QuotientGroupScheme}
	Let $G$ be an $S$-group scheme and $H \subset G$ a finite flat closed
	subgroup scheme.
	Define the action $a\colon G \cross_{ S } H \to G$ as the restriction of the
	group law $m$ on $G$.
	Then $G/H$ is the scheme of {\em left cosets} of $H$ in $G$.

	Assume, moreover, that $G/H$ is finite and flat over $S$,
	with order $[(G/H):S]$. We will call this the order of $H$ in $G$
	and denote it by $[G:H]$.
	Then $G$ is finite and flat over $S$ and we have
	\begin{equation*}
		[G:H][H:S] = [G:S]
	.\end{equation*} 
\end{prop}

\begin{rem}[Short exact sequence]
	Assume, in the hypothesis of \cref{thm:QuotientGroupScheme}, that $H$ is
	{\em normal} in $G$, i.e. that it acts trivially on $G/H$.
	Then the multiplication on $G$ induces a multiplication 
	morphism on $G/H$, making it an $S$-group scheme.
	Moreover the map $u\colon G \to G/H$ is
	an $S$-group homomorphism.
	In particular this gives rise to the short exact sequence of group schemes
	\begin{equation*}
	\begin{tikzcd}
		1 \arrow[r, "", rightarrow] &
		H \arrow[r, "i", rightarrow] &
		G \arrow[r, "u", rightarrow] &
		G/H \arrow[r, "", rightarrow] &
		1
	,\end{tikzcd}
	\end{equation*}
	where short exactness also means that $i$ is a closed immersion
	and $u$ is faithfully flat.
	Moreover $1$ denotes the constant $S$-group scheme $1$, as
	seen in \cref{ex:ConstantGroups} of the examples.
\end{rem}


\subsubsection{Separable algebras and étale group schemes}
The study of étale group schemes is strictly related to that of
separable algebras, so here are a few interesting results for the latter:

\begin{thm}[\cite{Waterhouse}, \textsection $6.2$]
	\label{thm:SeparableAlgebrasCharacterization}
	Let $k$ be a field and denote by $\overline{k}$ and $k^s$ respectively
	an algebraic and separable closure of $k$.
	Let $A$ be a finite dimensional $k$-algebra.
	The following are equivalent:
\begin{enumerate}
	\item $A \otimes_k \overline{k}$ is reduced.
	\item $A \otimes_k \overline{k} \simeq \overline{k} \cross \cdots \cross \overline{k}$.
	\item The number of $k$-algebra homomorphisms $A \to  \overline{k}$
		equals the dimension of $A$ over $k$.
	\item $A$ is a product of separable field extensions of $k$.
	\item $A \otimes_k k^s \simeq k^s \cross \cdots \cross k^s$.
\end{enumerate}
If, moreover, $k$ is a perfect field, all of the above are equivalent to
\begin{enumerate}[resume]
	\item $A$ is reduced.
\end{enumerate}
\end{thm}


\begin{defn}[Separable algebra]
	A $k$-algebra $A$ satisfying the equivalent conditions of
	\cref{thm:SeparableAlgebrasCharacterization}
	is called {\em separable}.
\end{defn}


\begin{cor}[\cite{Waterhouse}, \textsection $6.2$]
	Subalgebras, quotients, products and tensor products of separable $k$-algebras
	are separable.
	Moreover, given $L/k$ a field extension, $A$ is separable over $k$
	iff $A \otimes_k L$ is separable over $L$.
\end{cor} 


\begin{defn}[Étale morphism of schemes]
	Let $f\colon X \to S$ be a morphism of schemes.
\begin{enumerate}
	\item We say that $f$ is étale at $x \in X$ iff there exists an affine
		open neighbourhood $\mathrm{Spec}(A) = U \subset X$ of $x$
		and an affine open $\mathrm{Spec}(R) = V \subset S$,
		with $f(U) \subset V$, such that the induced ring map
		$R \to A$ is étale.

	\item We say that $f$ is étale iff it is étale at every point of $X$.

	\item We say that $X \in \mathsf{Sch}_{ S }$ is étale iff its structure
		morphism is étale.
\end{enumerate}
\end{defn}


In fact we can use this characterization in our context thanks to
\begin{lem}[\cite{SP},
	\href{https://stacks.math.columbia.edu/tag/02GL}{Lemma 02GL}]
	\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
	\item A scheme $X$ is étale over a field $k$ iff $X = \mathrm{Spec}(A)$
		for a {\em separable} $k$-algebra $A$.
	\item If $f\colon X \to S$ is an étale morphism of schemes, then
		for every $s \in S$, then the fiber at $s$ is given by $X_s = \mathrm{Spec}(A_s)$,
		for a separable $\kappa(s)$-algebra $A_s$, where
		$\kappa(s)$ denotes the residue field of $S$ at $s$.
\end{enumerate}
\end{lem} 

\subsubsection{Connected-étale exact equence}
In the following section we will always assume that 
$S = \mathrm{Spec}(R)$	for a henselian local ring $R$.
We will denote by $\mathfrak{m}$ its maximal ideal, by $k \coloneqq R/\mathfrak{m}$
its residue field and by $s \coloneqq \mathrm{Spec}(k)$ the closed point of $R$.
Finally by $G$ we will denote a finite and flat $S$-group scheme.

\begin{thm}[Connected-étale exact sequence, \cite{TateMF}, \textsection $3.7$]
	Let $G^0$ be the connected component of the identity in $G$.
	Then $G^0$ is the spectrum of a local $R$-algebra, with residue field $k = R/\mathfrak{m}$
	and it is a flat, closed normal subgroup scheme of $G$.
	Moreover the quotient $G^{et} \coloneqq G/G^0$,
	constructed as in \cref{thm:QuotientGroupScheme},
	is étale and gives rise to the short exact sequence
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		G^0 \arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		G^{et} \arrow[r, "", rightarrow] &
		0
	,\end{tikzcd}
	\end{equation*}
	called the {\em connected-étale sequence} for $G$.
	In particular it can be characterized by the fact that every homomorphism
	from $G$ to an étale $S$-group factorizes through $G \to G^{et}$,
	and $G^0$ is the kernel of that homomorphism.
\end{thm}


\begin{prop}[\cite{TateMF}, \textsection $3.7$]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
	\item Assume $\mathrm{char}\, k = 0$, then $G^0 = S$
		and $G = G^{et}$.
		If, instead, $\mathrm{char}\, k = p > 0$, the order
		$[G^0:S] = p^t$ for some $t$.
		As a consequence if $[G:S]$ is invertible in $S$, then
		$G$ is étale over $S$.

	\item If $R = k$ is a field and $n = [G:S]$, then $x^n = 1$
		for all $x \in G(B)$ for any $k$-algebra $B$.
		We say that $G$ is killed by its order.

	\item If $R$ is a perfect field, then the homomorphism
		$G \to  G^{et}$ admits a section. 
		As a consequence $G = G^0 \rtimes G^{et}$
		can be expressed as a semidirect product.
\end{enumerate}
\end{prop}


\subsection{Duality}
In this section we'll mainly be concerned with $S = \mathrm{Spec}(R)$ affine
and $G$ finite commutative over $S$, hence affine, let's say $G = \mathrm{Spec}(A)$.


\begin{rem}[Dual algebra]
	To the $R$-algebra $A$ we can associate the $R$-module
	\begin{equation*}
	A^D \coloneqq \mathrm{Hom}_{R\text{-}\mathsf{Mod}} \left( A, R \right)
	.\end{equation*} 
	In case $A$ is given with a cocommutative Hopf algebra structure, one
	can dualize it to obtain a (cocommutative) Hopf algebra structure on $A^D$.
	In particular product and coproduct of $A$ become, respectively,
	coproduct and product of $A'$, as
	\begin{equation*}
	\begin{tikzcd}
		(\widetilde{\Delta})^*\colon
		A^D \arrow[r, "", rightarrow] &
		A^D \otimes_R A^D &
		\text{\text{and}} &
		(\widetilde{m})^*\colon
		A^D \otimes_R A^D \arrow[r, "", rightarrow] &
		A^D 
	.\end{tikzcd}
	\end{equation*}
\end{rem}

\begin{defn}[Cartier dual]
	Given a $S$ and $G$ as before, we define the {\em dual} of $G$ as the
	group scheme defined by
	\begin{equation*}
	G^D \coloneqq \mathrm{Spec}(A^D)
	.\end{equation*}
\end{defn}


\begin{thm}[Cartier duality, \cite{Waterhouse}, \textsection $2.4$]
	Let $G$ be a finite, commutative $R$-group scheme.
	Then $G^D$ is a finite commutative $S$-group scheme.
	Moreover $( G^D )^D \simeq G$ and
	\begin{equation*}
	\mathrm{Hom}_{} \left( G, H \right) \simeq
	\mathrm{Hom}_{} \left( H^D, G^D \right)
	\end{equation*}
	for all $H,G \in \mathsf{Gp}_S$ finite commutative.
\end{thm}

\begin{rem}[]
	Duals of finite commutative group schemes inherit some other properties,
	in fact $[G^D : S] = [G : S]$.
	Moreover the dual of a short exact sequence is short exact.
\end{rem}

One can also interpret duality from a different point of view.
Here the relevant notions:
\begin{defn}[Characters of $\mathrm{S}$-groups]
	Let $G$ be an $S$-group scheme.
	A {\em character} of $G$ is a homomorphism of $S$-groups
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\chi\colon G \arrow[r, "", rightarrow] &
		(\mathbb{G}_m)_S
	.\end{tikzcd}
	\end{equation*} 
\end{defn}


\begin{rem}[Dual as hom functor, \cite{Waterhouse}, \textsection $2.4$]
	Characters form a subgroup of the set of morphism of $S$-schemes
	between $G$ and $(\mathbb{G}_m)_S$, which we will denote by
	\begin{equation*}
		\mathrm{Hom}_{\mathsf{Gr}_S} \left( G, (\mathbb{G}_m)_S \right)
		\subset
		\mathrm{Hom}_{\mathsf{Sch}_{ S }} \left( G, (\mathbb{G}_m)_S \right)
	.\end{equation*} 
	Then one can introduce the contravariant sheaf hom functor,
	from $\mathsf{Sch}_{ S }$ to $\mathsf{Ab}$
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\mathcal{H}\mathrm{om}_{\mathsf{Gr}_S} \left( G, (\mathbb{G}_m)_S \right)\colon
		T \arrow[r, "", mapsto] & 
		\mathrm{Hom}_{\mathsf{Gr}_T} \left( G_T, (\mathbb{G}_m)_T \right)
	.\end{tikzcd}
	\end{equation*} 
	Then, for a finite, commutative $S$-group $G$ we have the isomorphism
	\begin{equation*}
		G^D \simeq \mathcal{H}\mathrm{om}_{\mathsf{Gr}_S} \left( G, (\mathbb{G}_m)_S \right)
	.\end{equation*} 
	This is actually one of the cases in which the above hom functor
	is representable.
\end{rem}


Let's now give a few examples of dual group schemes among the ones we introduced so far:
\begin{ex}[]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
	\item The dual algebra of $R^\Gamma$ is $R[\Gamma]$ and viceversa.
		Hence diagonalizable finite group schemes are dual to constant commutative group schemes.
		In particular this yields that $\mu_n$ is dual to $\underline{\mathbb{Z}/n\mathbb{Z}}$
		and viceversa.

	\item One can show that $\left( \alpha_p \right)^D \simeq \alpha_p$.
\end{enumerate}
\end{ex}
\end{document}
