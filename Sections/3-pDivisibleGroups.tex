\documentclass[../Main]{subfiles}
\begin{document}
\section{\texorpdfstring{$p$}{p}-divisible groups}
In all that follows $p$ will be a fixed prime number.
Moreover $R$ denotes a commutative ring.

The aim of this section is to introduce, from two different points of view,
the notions of {\em $p$-divisible group} and of {\em formal Lie group},
and to show how the two concepts are related to one another.
Before doing so, though, we need to introduce a new notion, that
of formal scheme.


\subsection{Formal schemes}
These definitions are meant to allow to capture infinitesimal
information, which is not present in the construction of schemes.
We will not have time to discuss such interpretation, and will
only restrict to stating the definitions and results which will
be needed in what follows.
This section is strongly inspired from 
\cite[\href{https://stacks.math.columbia.edu/tag/0AHY}{Section 0AHY}]{SP},
which in turn bases itself on \cite[\S10]{EGA1}.

Let's start by recalling a few useful algebra defintions.

\begin{defn}[Topological rings and modules]\leavevmode\vspace{-1\baselineskip}
\begin{enumerate}
\item We say that a ring $R$ is a {\em topological ring} iff it is a ring endowed with a topology
	such that both addition and multiplication are continuous maps
	$R \cross R \to R$, where $R \cross R$ is taken with the product topology.

\item We say that an $R$-module $M$, where $R$ is a topological ring,
	is a {\em topological module} iff $M$ is enodwed with a topology such that
	addition and scalar multiplication are both continuous, again with their source
	taken with the product topology.

\item $R$ is {\em linearly topologized} iff $0$ has a fundamental system
	of neighbourhoods consisting of ideals.
	Analogously $M$ is {\em linearly topologized} iff $0$ has a fundamental
	system of neighbourhood consisting of submodules.

\item If $R$ is linearly topologized, we say that the ideal $I \triangleleft R$
	is an {\em ideal of definition} iff $I$ is open and every neighbourhood
	of $0$ contains $I^n$ for an appropriate $n \in \mathbb{N}$.

\item $R$ is {\em admissible} iff it has an ideal of defintion and it is {\em complete}.
\end{enumerate}
\end{defn}


\begin{defn}[Completed tensor product]
	Let $R$ be a topological ring and $M, N$ be linearly topologized $R$-modules.
	Let $M_\mu \triangleleft M$ and $N_\nu \triangleleft N$ run through
	fundamental systems of open submodules of $M$ and $N$ respectively.
	We endow the tensor product of $M$ and $N$ with the linear topology
	defined by the fundamental system of open submodules
	\begin{equation*}
	\begin{tikzcd}
	\ima \{ M_\mu \otimes_R N + M \otimes_R N_\nu 
		\arrow[r, "", rightarrow] &
	M \otimes_R N \}
	.\end{tikzcd}
	\end{equation*}
	Then we define the {\em completed tensor product} as the completion
	of the tensor product, i.e.
	\begin{equation*}
		M \widehat{\otimes}_R N = 
		\varprojlim \frac{M \otimes_R N}{M_\mu \otimes_R N +
		M \otimes_R N_\nu} =
		\varprojlim M / M_\mu \otimes_R N / N_\nu
	.\end{equation*}
\end{defn}


\begin{rem}[]
	In the case where $R$ is a complete topological ring,
	$M = R [\![ X_1, \ldots, X_{ n } ]\!]$
	and $N = R [\![ Y_1, \ldots, Y_{ m } ]\!]$,
	one obtains the isomorphism
	\begin{equation*}
		R [\![ X_1, \ldots, X_{ n } ]\!] \widehat{\otimes}_R
		R [\![ Y_1, \ldots, Y_{ m } ]\!] \simeq
		R [\![ S_1, \ldots, S_n, T_1 \ldots, T_{ m } ]\!]
	.\end{equation*}
	Above we denoted by $S_j \coloneqq X_j \otimes 1$
	and by $T_j \coloneqq 1 \otimes Y_j$.
\end{rem}


\begin{defn}[Pseudo-discrete sheaves]
	A sheaf of topological rings (analogously modules, etc)
	is called {\em pseudo-discrete} iff, for all $U \subset X$,
	$\mathcal{F}(U)$ is enodwed with the discrete topology.
\end{defn}


\begin{defn}[Associated pseudo-discrete sheaf]\label{defn:AssociatePDSheaf}
	Let $X$ be a topological space with a basis of the topology
	consisting of quasi compact open subsets (for example $\mathrm{Spec}(R)$
	for a ring $R$).
	Given any sheaf $\mathcal{F}$ of rings (analogously modules, etc)
	we define the {\em associated pseudo-discrete sheaf},
	still denoted by $\mathcal{F}$, as the sheaf
	of {\em topological} rings (analog$.$ modules, etc)
	with topologies defined as follows.
	To each $U \subset X$ open and quasi compact we endow
	$\mathcal{F}(U)$ with the discrete topology.
	For an arbitrary open $U = \cup_{i \in I} U_i$, where $U_i$ are all
	quasi compact open, we endow $\mathcal{F}(U)$ with the
	induced topology from $\Pi_{i \in I} \mathcal{F}(U_i)$.
\end{defn}


\begin{rem}[]
	In the above one should verify good definition of the topology
	and also should define how to endow $\mathcal{F}(U)$
	with the induced topology from $\Pi_{i \in I} \mathcal{F}(U_i)$.
	For questions of space we will leave these verifications to
	\cite[\href{https://stacks.math.columbia.edu/tag/0AHY}{Section 0AHY}]{SP}
	and \cite[\S10]{EGA1}.
\end{rem}


\begin{defn}[Locally topologically ringed spaces]
	We define a {\em locally topologically ringed space}, 
	for short {\em ltrs}, to be a pair
	$( X , \mathcal{O}_{ X } )$ consisting of a topological space $X$
	and a sheaf of topological rings $\mathcal{O}_X$,
	whose stalks are local rings.
	A {\em morphism of ltrs}
	$( X , \mathcal{O}_{ X } ) \to  ( Y , \mathcal{O}_{ Y } )$
	is a pair $\left(f, f^\#\right)$,
	where $f\colon X \to Y$ is a continuous map
	and $f^\#\colon \mathcal{O}_Y \to f_* \mathcal{O}_X$ is
	a morphism of sheaves such that, for all $V \subset Y$ open,
	the map
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		f^\#_V\colon \mathcal{O}_{ X }(V) \arrow[r, "", rightarrow] &
		\mathcal{O}_{ X }(f^{-1}(V))
	\end{tikzcd}
	\end{equation*} 
	is continuous and, for all $x \in X$, the induced map at the level
	of stalks
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		f^\#_x\colon \mathcal{O}_{ Y,f(x) } \arrow[r, "", rightarrow] &
		\mathcal{O}_{ X,x }
	\end{tikzcd}
	\end{equation*} 
	is a local homomorphism of rings (here we forget about topology).
\end{defn}


We now have enough basic definitions to give that of formal scheme.
Let's notice that this construction follows that of \cite[\S10]{EGA1},
hence all of the verifications can be checked there.

\begin{defn}[Affine formal scheme]\leavevmode\vspace{-\baselineskip}
\begin{enumerate}
\item Let $A$ be an {\em admissible ring}, with fundamental system of
	neighbourhoods $\left\{ I_\lambda \right\}_{\lambda \in \Lambda}$.
	We define
	\begin{equation*}
	\mathrm{Spf}(A) \coloneqq
	\left\{ \mathfrak{p} \triangleleft A \ \middle|\ \mathfrak{p}
	\text{ is open and prime}\, \right\} \subset \mathrm{Spec}(A)
	,\end{equation*}
	and endow $\mathrm{Spf}(A)$ with the subset topology.
	For each $\lambda \in \Lambda$, one can associate,
	as in \cref{defn:AssociatePDSheaf},
	to the structure sheaf $\mathcal{O}_{\mathrm{Spec}(A/I_\lambda)}$
	of $\mathrm{Spec}(A/I_\lambda)$,
	a pseudo-discrete sheaf, which we will denote by $\mathcal{O}_\lambda$.
	One should indeed notice that, for all $I_\lambda$,
	$\mathrm{Spec}(A/I_\lambda)$ has indeed tha the same topological space
	of $\mathrm{Spf}(A)$.
	Moreover, for $I_\lambda \subset I_\mu$, one has an induced homomorphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\mathrm{Spec}(A/I_\mu) \arrow[r, "", rightarrow] &
		\mathrm{Spec}(A/I_\lambda)
	,\end{tikzcd}
	\end{equation*} 
	which gives rise to a compatible system.
	Then one defines
	\begin{equation*}
	\mathcal{O}_{\mathrm{Spf}(A)} \coloneqq
	\varprojlim_{\lambda \in \Lambda} \mathcal{O}_\lambda
	,\end{equation*}
	where the limit is taken in the category of sheaves of topological rings.
	Finally one defines the pair $( \mathrm{Spf}(A) , \mathcal{O}_{ \mathrm{Spf}(A) } )$
	to be the {\em formal spectrum} of $A$.

\item A {\em ltrs} is said to be an {\em affine formal scheme} iff it is isomorphic,
	as ltrs, to the spectrum of an admissible ring.
	A morphism of affine formal schemes is just a morphism of the underlying
	locally topologically ringed spaces.
\end{enumerate}
\end{defn}


\begin{rem}[]
	As in the definition of associated pseudo-discrete sheaf, in the above
	there are many details to be checked and filled.
	Again we will leave them to \cite[\S10]{EGA1}.
\end{rem}


\begin{rem}[]\label{EquivalenceFormalAffineSchemes}
	One can prove that, mush like with affine schemes, the category of affine
	formal schemes is anti-equivalent to that of admissible topological rings.
	In particular we have
	\begin{equation*}
	\mathrm{Hom}_{\mathsf{ltrs}} \left( \mathrm{Spf}(B), \mathrm{Spf}(A) \right) \simeq
	\mathrm{Hom}_{ \mathrm{cont} } \left( A, B \right)
	,\end{equation*}
	where in the left hand side we denoted by $\mathsf{ltrs}$ the category of
	locally topologically ringed spaces, whereas in the right hand side
	we considered only continuous morphisms of rings, i.e. morphisms
	in the category of admissible topological rings.
\end{rem}


\begin{defn}[Formal scheme]
	A {\em formal scheme} is a ltrs $( \mathfrak{X} , \mathcal{O}_{ \mathfrak{X} } )$
	such that every point has an open neighbourhood isomorphic,
	in $\mathsf{ltrs}$, to an {\em affine formal scheme}.
	A morphism of formal schemes is just a morphism of the underlying
	locally topologically ringed spaces.
\end{defn}


\begin{rem}[]
	Following the construction of associated pseudo-discrete sheaf,
	to any sheaf one can associate a formal sheaf.
	This actually gives rise to a fully faithful embedding of the category of schemes
	in that of formal schemes.
\end{rem}


To ease the transition to the study of $p$-divisible groups
let's also recall a couple of results with these objects.
\begin{rem}[]
	In this remark we will restrict to the affine case, because it will be
	our main interest.
	Given an admissible ring $A$, with fundamental system of
	of ideals $\left\{ I_\lambda \right\}_{\lambda \in \Lambda}$, then
	we have
	\begin{equation*}
	\mathrm{Spf}(A) \simeq \varinjlim_{\lambda \in \Lambda} \mathrm{Spec}(A/I_\lambda)
	\end{equation*}
	in the category of formal schemes.
	In fact, as can be seen in \cite[\S10.6]{EGA1}, one can do a similar construction
	with formal schemes.
	Hence we can view these last as inductive limits of ordinary schemes.
\end{rem}


\begin{rem}[]\label{VeryFiniteSchemes}
	Moreover, with regards to the construction of $p$-divisible groups
	and formal Lie groups, we will follow \cite[\S5]{Shatz} for the point
	of view of formal schemes.
	Then, as we will remark again, we fix $R$ a 
	local admissible ring and $S \coloneqq \mathrm{Spec}(R)$.
	Moreover we will meainly deal with formal affine schemes over $S$ which
	are given by inductive limits of what Shatz defines {\em very finite} schemes over $S$.
	These are $S$-schemes $T$ satisfying:
	\begin{enumerate}
		\item $T$ is {\em finite} over $S$ (hence affine);
		\item the $R$-module $\Gamma \left( T , \mathcal{O}_{ T } \right)$
			is of finite length.
	\end{enumerate}
	Specializing \cref{EquivalenceFormalAffineSchemes} to the case of
	formal affine schemes over $S$, 
	as just defined,
	we obtain an anti-equivalence of categories with the category of
	profinite $R$-algebras.
	This is the setting in which we will state most results in the 
	formal scheme setting in the following sections.
\end{rem}


tk: even though it is a pretty powerful result, is it really needed?
\begin{thm}[{\cite[\S5]{Shatz}}, Grothendieck]
	A functor from profinite $R$-algebras to $\mathsf{Sets}$ (resp$.$ $\mathsf{Gp}$)
	is representable iff it is {\em left exact}, i.e.
	iff it commutes with fibered products and final elements.
\end{thm}
In what follows this theorem will be applied, sometimes,
to formal schemes. In such case, the anti-equivalence of \cref{EquivalenceFormalAffineSchemes}
implies that one need to check {\em right exactness} instead of left exactness.

\subsection{Formal groups and formal Lie groups}
In this section we will define the concept of {\em formal Lie group},
generalizing that of Lie group, i.e. that of group (tk: I'd look for a description
on wikipedia, if I'm not mistaken it is the infinitesimal linear expansion of
the action of a VS on a manifold), without the restriction of convergence.

As will be usual (tk: has it become so?) throughout this section we will define
concepts both in terms of formal schemes, borrowing from \cite{Shatz},
and in terms of {\em fppf} sheaves, borrowing from \cite{Messing}.


tk: the following is just a draft. Please check its correctness

\subsubsection{Formal scheme point of view}
As anticipated in \cref{VeryFiniteSchemes},
we fix $R$ a local admissible ring, $S \coloneqq \mathrm{Spec}(R)$
and we work only with inductive limits of {\em very finite} $S$-schemes.
\begin{defn}[Formal group schemes]
	A {\em formal group scheme}
	is just a group object in the category of formal schemes,
	 as defined in \cref{groupObject}.
	Analogously a {\em formal $S$-group scheme}
	is a group object in the category of formal schemes over $S$.
\end{defn}


\begin{rem}[]\label{FormalHopf}
	As with the case of group schemes, in the affine case
	$G = \mathrm{Spf}(\mathscr{A})$,
	one defines, on $\mathscr{A}$, comultiplication, antipode and counit morphisms
	with the usual properties of \cref{defn:HopfAlgebra}.
	One should note, though, that in the category of 
	profinite $R$-algebras, the coproduct id given by
	the completed tensor product, hence the comultiplication
	is a morphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\widetilde{m}\colon \mathscr{A} \arrow[r, "", rightarrow] &
		\mathscr{A} \widehat{\otimes}_R \mathscr{A}
	.\end{tikzcd}
	\end{equation*} 
\end{rem}


One can generalize the results of \cref{ConnecteEtaleSequenceGS} to this new setting.
\begin{thm}[{\cite[\S5]{Shatz}}]
	Let $G$ be a formal group scheme over $S$.
	Then there is a canonical exact sequence
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		G^0 \arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		G^{et} \arrow[r, "", rightarrow] &
		0
	\end{tikzcd}
	\end{equation*}
	in which $G^0$ is a connected normal formal group of $G$
	and $G^{et}$ is an étale formal group.
\end{thm}


The following definition is, again, not the most general one, but
the right one in our context.
\begin{defn}[Formal Lie variety]\leavevmode\vspace{-1\baselineskip}
\begin{enumerate}
	\item A formal $S$-scheme $G$ is said to be {\em smooth} iff
		$G^0$ is the formal spectrum of a power series ring over $R$.
	\item A {\em formal Lie variety} over $S$ is a smooth, connected formal $S$-scheme.
\end{enumerate}
\end{defn}

\begin{defn}[Formal Lie group]\label{defn:FormalSchemeFormalLieGroup}
	A {\em formal Lie group} is a group object in the category of
	formal Lie varieties.
	More explicitly it is $\Gamma \coloneqq \mathrm{Spf}\left( \mathscr{A} \right)$,
	where $\mathscr{A} \coloneqq R [\![ X_1, \ldots, X_{ n } ]\!]$
	and $n$ is its dimension. 
\end{defn}


\begin{rem}[]
	As stated in \cref{FormalHopf}, since a formal Lie group
	is an affine formal scheme, one gets a Hopf algebra structure
	on $\mathscr{A}$.
	As formal Lie groups are often introduced giving focus only
	on the comultiplication morphism and its axioms, we will
	recall them here, with names which can be found in the literature.
	More explicitly comultiplication of the formal Lie group
	$\mathrm{Spf}(\mathscr{A})$ is a morphism of topological rings
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		f\colon \mathscr{A} \arrow[r, "", rightarrow] &
		\mathscr{A} \widehat{\otimes}_R \mathscr{A} =
		R [\![ X_1, \ldots, X_{ 2n } ]\!]
	,\end{tikzcd}
	\end{equation*} 
	satisfying the following conditions:
	\begin{enumerate}
		\item {\em $\varepsilon$ axiom:} $X = f(X,0) = f(0,X)$,
		\item {\em coassociativity:} $f(X, f(Y,Z)) = f(f(X,Y), Z)$,
		\item {\em commutativity:} $f(X,Y) = f(Y,X)$.
	\end{enumerate}
	Notice that any such morphism $f$ is just the data of 
	$\left( f_i(Y,Z) \right)_{i=1}^n$, power series in $2n$ variables, where
	$f_i$ is the image of $X_i$ via $f$.
	Again, as is often found in the literature, one denotes the image of
	comultiplication by
	\begin{equation*}
		X \ast Y \coloneqq f(X,Y)
	.\end{equation*} 
	One can also stress that these axioms are enough to grant
	the existance of the inverse for any element of $\Gamma$,
	hence they suffice to give $\Gamma$ a group scheme structure.

	(tk: make this note a bit better.)
	Finally a note on the terminology one often finds: this
	is chosen to be closer to the analogous concept of Lie groups
	in differential geometry.
\end{rem}


\begin{defn}[$p$-divisible formal Lie group]\label{defn:pDivisibleFormalLieGroup}
	We define the map multiplication by $p$ on $\Gamma \coloneqq \mathrm{Spf}(\mathscr{A})$
	as the map $p\colon \Gamma \to \Gamma$
	associated to 
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\psi\colon \mathscr{A} \arrow[r, "", rightarrow] &
		\mathscr{A} \widehat{\otimes}_R \mathscr{A} \\
		X \arrow[r, "", mapsto] & 
		X \ast \ldots \ast X
	\quad \text{($p$ times)}
	.\end{tikzcd}
	\end{equation*} 
	If, moreover, $\Gamma$ is a formal Lie group, 
	it is said to be {\em $p$-divisible} iff the map $p$ is 
	an isogeny, i.e. it is surjective and has finite kernel.
	This means that $\mathscr{A}$ is a {\em free} module of finite rank over itself.
\end{defn}



\subsubsection{fppf sheaves point of view}
tk: this part has to be read again, it was just a copy-paste!
Moreover I have to fix the references (I can quote directly the theorem number!)

In the following part we will always write groups over $S$, or $S$-group, to mean
an fppf sheaf of commutative groups on the site $(\mathsf{Sch}_{ S })_{\mathrm{fppf}}$.
Also the schemes $X, Y$ will be viewed as sheaves on $S$
for the {\em fppf} topology.
Recall that, for $Y \in \mathsf{Sch}_{ S }$, sections on
$T \in \mathsf{Sch}_{ S }$ of $Y$ are just $T$-points and,
as usual with sheaves, will denote them by
\begin{equation*}
	\Gamma \left( T, Y \right) \coloneqq Y(T)
.\end{equation*}


\begin{defn}[$k$-th infinitesimal neighbourhood]\label{defn:kInfNeighbourhood}
	Let $Y \hookrightarrow X$ be a monomorphism of {\em fppf} sheaves.
	We define $\mathrm{Inf}_Y^k(X)$ as the subsheaf of $X$,
	whose sections over an $S$-scheme $T$, denoted by $\Gamma ( T , \mathrm{Inf}_Y^k(X) )$,
	are given as follows:
	$\Gamma ( T , \mathrm{Inf}_Y^k(X) )$ is the subsets of all
	$t \in \Gamma \left( T, X \right)$ such that
	there is a covering $\left\{ T_{ i } \to T \right\}_{ i \in I }$
	of $T$ and, for each $i$, a closed subscheme $T_i'$ of $T_i$,
	defined by an ideal whose $(k+1)$-st power is $(0)$,
	with the property that every element $\left.t\right|_{T_i'} \in \Gamma(T'_i, X)$
	is already an element of $\Gamma(T_i', Y)$.
\end{defn}


\begin{defn}[]
	Let $X$ be a sheaf on $S$, with a section $e_X\colon S \to X$.
	If this section is clear from context, e.g. in case we have
	$(X, e_X)$ a pointed sheaf on $S$, i.e. a sheaf on $S$
	given with a section $e_X\colon S \hookrightarrow X$,
	we will write $\mathrm{Inf}^k(X)$
	instead of $\mathrm{Inf}_S^k(X)$.
\end{defn}


\begin{defn}[Ind-infinitesimal sheaf]
	A pointed sheaf $\left(X, e_X\right)$ is called {\em ind-infinitesimal} iff,
	as an {\em fppf sheaf}
	\begin{equation*}
		X = \varinjlim_{k \in \mathbb{N}} \mathrm{Inf}^k(X)
	.\end{equation*}
\end{defn}


Right now we need to introduce a couple more concepts from algebraic
geometry to make sense of the definitions which are at the heart of this section.
\begin{defn}[Quasi-coherent sheaf of $\mathcal{O}_{ X }$-modules]
	Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_{ X }$-modules.
	We say that $\mathcal{F}$ is a {\em quasi-coherent sheaf of $\mathcal{O}_{ X }$-modules}
	iff, for every point $x \in X$, there is an open neighbourhood $x \in U \subset X$
	on which $\left.\mathcal{F}\right|_{U}$ is isomorphic to the cokernel
	of a map
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\bigoplus_{j \in J} \mathcal{O}_{ U } \arrow[r, "", rightarrow] &
		\bigoplus_{i \in I} \mathcal{O}_{ U }
	.\end{tikzcd}
	\end{equation*}
	More explicitly this means that $X$ is covered by open subsets $U$,
	on each of which $\left.\mathcal{F}\right|_{U}$ admits a presentation
	of the form of the following exact sequence:
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex]
		\bigoplus_{j \in J} \mathcal{O}_{ U } \arrow[r, "", rightarrow] &
		\bigoplus_{i \in I} \mathcal{O}_{ U } \arrow[r, "", rightarrow] &
		\left.\mathcal{F}\right|_{U} \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
	This implies that:
	\begin{enumerate}
		\item for all $x \in X$ there is an open neighbourhood $x \in U \subset X$
			on which $\left.\mathcal{F}\right|_{U}$ is generated by global sections;

		\item for a suitable choice of these sections, the kernel of the associated surjection
			is also generated by global sections.
	\end{enumerate}
\end{defn}


\begin{defn}[Conormal sheaf of an immersion]
	Let $i\colon Z \to X$ be a closed immersion of schemes.
	Let $\mathcal{I} \subset \mathcal{O}_X$ be the corresponding
	quasi-coherent sheaf of ideals.
	Then the sheaf $\mathcal{I}/\mathcal{I}^2$ is annihilated by $\mathcal{I}$,
	hence it corresponds to a sheaf on $Z$.
	This last sheaf, denoted with $\underline{\omega}_i$, is called the {\em conormal
	sheaf} of $Z$ in $X$, or the conormal sheaf of the immersion.
	In case we are given a pointed sheaf on $S$ $\left(X, e_X\right)$, we will denote 
	the conormal sheaf of the immersion $e_X$ simply by
	$\underline{\omega}_X$.
\end{defn}
tk: I should prove that $S \hookrightarrow X$ is a closed immersion


And now back to our interests.
\begin{defn}[Formal Lie variety]
	A pointed sheaf $\left(X, e_X\right)$ on $S$ is said to be
	a {\em formal Lie variety} iff it satisfies the following:
\begin{enumerate}
	\item $X$ is ind-infinitesimal and $\mathrm{Inf}^k(X)$, viewed
		as a sheaf in the {\em fppf} topology,
		is representable for all $k \geq 0$;
	\item $\underline{\omega}_X \simeq
		e_X^* \left( \Omega_{X/S} \right) \simeq
		e_X^* \big( \Omega_{\mathrm{Inf}^k(X)/S} \big)$
		is {\em locally free of finite type};
	\item Denoting by $\mathrm{gr}^{\mathrm{inf}}(X)$ the unique graded $\mathcal{O}_{ S }$-algebra
		such that $\mathrm{gr}^{\mathrm{inf}}_i(X) = \mathrm{gr}_i(\mathrm{Inf}^i(X))$,
		we have an isomorphism
		\begin{equation*}
		\begin{tikzcd}[row sep = 0ex
			,/tikz/column 1/.append style={anchor=base east}
			,/tikz/column 2/.append style={anchor=base west}]
		\mathrm{Sym}\left( \underline{\omega}_X \right) \arrow[r, "\sim", rightarrow] &
				\mathrm{gr}^{\mathrm{inf}}(X)
		\end{tikzcd}
		\end{equation*}
		induced by the canonical mapping
		$\underline{\omega}_X \xrightarrow{\sim} \mathrm{gr}_1^{\mathrm{inf}}(X)$.
\end{enumerate}
\end{defn}


\begin{rem}[{\cite[\S2.1]{Messing}}]\label{FormalLieVarietyPowerSeries}
	From this definition it follows that $X$, locally on $S$,
	is given by $\mathcal{O}_S [\![ T_1, \ldots, T_n ]\!]$.
	In particular, in the case we work in, for the formal scheme point of view,
	it grants that $X$ is given by
	$R [\![ T_1, \ldots, T_n ]\!]$.
\end{rem}


\begin{defn}[Formal Lie group]
	A {\em formal Lie group} over $S$ is a group object $\left(G, e_G\right)$
	in the category of formal Lie varieties over $S$.
\end{defn}
tk: I think this is going to be fundamental in order to take duals, etc.
In the following we will always assume that a formal Lie group $\left(G, e_G\right)$
is commutative.

tk: do I keep this remark?
Our next aim is to find a connection between Barsotti-Tate groups and formal Lie groups,
so let's start with some preliminary result:
\begin{lem}[{\cite[\S2.1, lemma 1.1.6]{Messing}}]
	Let $G$ be an $S$-group scheme.
	Then $\overline{G} \coloneqq \varinjlim_{k \in \mathbb{N}} \mathrm{Inf}^k(G)$
	is also a group.
\end{lem}


Assume now that our base scheme $S$ is of characteristic $p  > 0$.
\begin{rem}[Frobenius and Verschiebung]
One can generalize the definitions given for finite commutative group scheme
in \cref{sec:FrobeniusVerschiebung}.
In fact, looking at how they act on $S$-points, these
definitions can be generalized to any contravariant functor
from $\mathsf{Sch}_{ S }$ to $\mathsf{Sets}$.
Then, on any sheaf of groups $G$, a Frobenius morphism,
denoted again by $F_G\colon G \to G^{(p)}$, 
and a Verschiebung morphism, denoted by $V_G \colon G^{(p)} \to G$.
Moreover, as in \cref{defn:nilpotentFrobenius} we denote by
$F^n_G\colon G \to G^{(p^n)}$ the $n$-fold composition
of the Frobenius.
\end{rem}


\begin{defn}[]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
\item We denote by $G[n] \coloneqq \ker F^n_G$, the kernel of the $n$-fold composition
	of the Frobenius morphism.

\item A sheaf of groups $G$ on $S$ is said to be {\em of $F$-torsion} iff
	$G = \varinjlim_{n \in \mathbb{N}} G[n]$.

\item A sheaf of groups $G$ on $S$ is said to be {\em $F$-divisible} iff
	$F_G\colon G \to G^{(p)}$ is an epimorphism.
\end{enumerate}
\end{defn}

Finally we can more easily characterize the formal Lie groups over
$S$ of characteristic $p$.
\begin{thm}[{\cite[\S2.2, theorem 2.1.7]{Messing}}]\label{MessingCharactLieGroup}
	In order for a sheaf of groups $G$ on $S$ to be a formal Lie group,
	it is necessary and sufficient that the following conditions hold:
\begin{enumerate}
	\item $G$ is of $F$-torsion,
	\item $G$ is $F$-divisible,
	\item The $G[n]$ are finite and locally free $S$-group schemes.
\end{enumerate}
\end{thm}


\begin{rem}[Comparison of the two points of view]
	From 
	\cref{MessingCharactLieGroup},
	\cref{FormalLieVarietyPowerSeries,defn:FormalSchemeFormalLieGroup}
	we see that the two definitions of formal Lie group coincide, over
	$S = \mathrm{Spec}(R)$, where $R$ is a local admissible ring.
	In fact from the definition as an fppf sheaf of groups,
	we obtain that $G$ is $F$-torsion.
	As a consequence every $G[n]$, up to base
	change to the residue field, satisfies conditions of \cref{FrobeniusChar2},
	which grants connectedness.
	Moreover we see that $G$ is given by a ring of formal power series,
	hence it is smooth.
	For the converse we recall
	\cref{reprFctSheaf},
	\cref{VeryFiniteSchemes,FrobeniusVerschiebungRelation}
	and then have to argue following \cite[porposition 1]{TatePC}, see
	also \cite[\S2, theorem 2.1.7]{Messing} for some more details.
\end{rem}



\subsection{\texorpdfstring{$p$}{p}-divisible groups}
Again, following the previous points of view, we will define $p$-divisible groups
from two different starting points: that of formal schemes
and that of fppf sheaves.



\subsubsection{Formal scheme point of view}
In this section we will follow the construction of \cite[\S2]{TatePC} and
of \cite[\S6]{Shatz}. 
In particular we will see a $p$-divisible group as a formal group
satisfying certain important properties.
As before, sticking to the convention of \cite{Shatz}, we will 
denote by $R$ an admissible local ring (and often assume that
it also has residue characteristic $p$).


\begin{defn}[$p$-divisible group]\label{defn:pDivGroupFormalSchemes}
	A {\em $p$-divisible group} over $R$ of height $h \in \mathbb{N}_+$ is an inductive system
	\begin{equation*}
	G \coloneqq \left(G_v, i_v\right)_{v \in \mathbb{N}}
	,\end{equation*} 
	satisfying:
	\begin{enumerate}
		\item for each $v \in \mathbb{N}$, $G_v$ is a finite, commutative group scheme over $R$
			of order $p^{v h}$,
		\item for each $v \in \mathbb{N}$, there is an exact sequence
			\begin{equation*}
			\begin{tikzcd}
				0 \arrow[r, "", rightarrow] &
				G_v \arrow[r, "i_v", rightarrow] &
				G_{v + 1} \arrow[r, "p^v", rightarrow] &
				G_{v + 1} 
			,\end{tikzcd}
			\end{equation*}
			where the second map is the multiplication by $p^v$ in $G_{v + 1}$,
			hence the first is a closed immersion which identifies
			$G_v$ with the kernel of $p^v$ on $G_{v+1}$.
	\end{enumerate}
\end{defn}


\begin{rem}[]
	Recalling \cref{VeryFiniteSchemes} we see that the inductive system 
	$\left( G_v, i_v \right)_{v \in \mathbb{N}}$ defines a formal group 
	\begin{equation*}
	G \coloneqq \varinjlim_{v \in \mathbb{N}} G_v
	.\end{equation*}
	Even though this remark allows to associate an object to a $p$-divisible 
	group, we will mostly work directly with the inductive system.
\end{rem}


We can actually characterize these objects a bit more. 
In fact the following proposition holds.
\begin{prop}\label{CharactpDivGroups}%[{\cite[\S6]{Shatz}}]
	A $p$-divisible group over $R$ is a $p$-torsion
	commutative formal group $G$ over $R$,
	for which $p\colon G \to G$ is an {\em isogeny}.
\end{prop}
\begin{proof}
	The following diagram then shows that $G_v$ is the kernel of $p^v$
	on $G_{v+2}$ via the iterated injection $i_{v+1} \circ i_v$.
	Inductively this holds for $G_{v+t}$, where $t \geq 1$:
	\begin{equation*}
	\begin{tikzcd}
		&
		&
		G_{v+2} \arrow[r, "p^v", rightarrow] &
		G_{v+2} \arrow[r, "p", rightarrow] &
		G_{v+2}\\
		0 \arrow[r, "", rightarrow] &
		G_{v} \arrow[r, "i_v"', rightarrow] &
		G_{v+1} \arrow[r, "p^v"', rightarrow] 
		\arrow[u, "i_{v+1}", rightarrow] &
		G_{v+1} \arrow[u, "i_{v+1}", rightarrow] &
	.\end{tikzcd}
	\end{equation*}
	As a consequence $G_v$ is the kernel of $p^v$ on $G$,
	hence $G$ is $p$-torsion (since it is $\varinjlim G_v$).
	Then we analyze the following diagram to obtain that $p$
	is an isogeny:
	\begin{equation*}
	\begin{tikzcd}[row sep=1.4em]
		G_{v+t+1} \arrow[rr, "p^t", rightarrow] & &
		G_{v+t+1} \arrow[r, "p^v", rightarrow] &
		G_{v+t+1}\\
		&
		G_v \arrow[ru, "i_{v,t+1}", rightarrow] 
		\arrow[rd, "i_{v,t}", rightarrow] 
		& & \\
		G_{v+t} \arrow[ru, "j_{t,v}", dashrightarrow] 
		\arrow[rr, "p^t"', rightarrow]
		\arrow[uu, "i_{v+t}", rightarrow] & &
		G_{v,t} \arrow[uu, "i_{v+t}"', rightarrow]
	.\end{tikzcd}
	\end{equation*}
	In fact the big square commutes and condition $2$ of the definition
	of $p$-divisible group, applied to $G_{v+t}$, implies that $p^t \circ i_{v+t}$
	factors through the kernel of $p^v$ on $G_{v+t+1}$.
	As seen above this is $G_v$, granting the existence of the 
	dashed arrow $j_{t,v}$.
	Moreover we obtain the commutativity of the right triangle by
	definition of inductive system.
	As a consequence also the lower triangle commutes, granting
	$i_{v,t} \circ j_{t,v} = p^t$.
	Then, as $i_{v,t}$ is a monomorphism, $\ker j_{t,v}$
	coincides with the kernel of $p^t$ on $G_{v+t}$, 
	which is $G_t$ by the above discussion.
	Then, by property $1$ of $p$-divisible groups,
	the order of $G_{v+t}$ is the product of the orders
	of $G_v$ and $G_t$, hence the following is a
	short exact sequence of abelian $S$-group schemes
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		G_t \arrow[r, "i_{t,v}", rightarrow] &
		G_{v+t} \arrow[r, "j_{t,v}", rightarrow] &
		G_v \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
	Let's remark that these computation do not depend on the chosen $t \geq 1$
	nor on the chosen $v$.
	Hence the above sequence is exact for all $v$ and $t$.
	In particular, fixing $t=1$ and letting $v$ vary,
	we obtain that $p\colon G \to G$ is an isogeny,
	i.e. it is onto and has kernel given by a finite group scheme over $S$.
\end{proof}


\begin{rem}[]
	This proposition actually has an inverse.
	In fact, starting from a $p$-torsion commutative formal group $G$ over
	$R$, for which $p\colon G \to G$ is an isogeny, we can recover a $p$-divisible
	group as in \cref{defn:pDivGroupFormalSchemes}.
	In fact setting $G_v \coloneqq \ker p^v$, as seen in \cref{CharactpDivGroups},
	and $i_v$ the inclusion of one kernel into the next gives an inductive system.
	The height $h$ is given by the exponent of the order of $\ker p$,
	and one checks that the order of $\ker p^v = p^{vh}$.
	Finally $G = \varinjlim_{v \in \mathbb{N}} G_v$ since it is $p$-torsion.
\end{rem}


\begin{ex}\leavevmode\vspace{-.2\baselineskip}\label{ex:pDivGroups}
\begin{enumerate}
\item In the case of ordinary abelian groups this definition would just allow
	$G_v = \left( \mathbb{Z}/p^v\mathbb{Z} \right)^h$, hence to the $p$-divisible group
	\begin{equation*}
		G = \varinjlim G_v = \left( \mathbb{Q}_p / \mathbb{Z}_p \right)^h
	.\end{equation*} 
\item In case we start considering an $n$-dimensional commutative\label{ConnectedpDivGroupFLG}
	formal Lie group $\Gamma$ over $R$, we clearly have to require that it is $p$-divisible,
	as defined in \cref{defn:pDivisibleFormalLieGroup}.
	Then multiplication by $p$ is an isogeny.
	In case, moreover, $R$ is complete and has residue characteristic $p$,
	one can define a $p$-divisible group of height $h$
	over $R$, starting from $\Gamma$, by the inductive system
	\begin{equation*}
		\Gamma(p) \coloneqq \left(\Gamma_{p^\nu}, i_{p^\nu}\right)_\nu
	.\end{equation*} 
	In the above $\Gamma_{p^\nu}$ is the kernel of the multiplication by $p^\nu$ 
	in $\Gamma$.
	Then one can prove that $\ker p$ is connected and, since $p$ is an isogeny,
	it is also finite.
	By \cref{prop:PropertiesConnecteEtale} this implies that the order of $\ker p$
	is a power of $p$.
	Then, using flatness (to base change to the residue field) and 
	\cref{FrobeniusVerschiebungRelation}, one can extend this result
	to $\ker p^v$ for all $v \geq 1$.
	Hence the construction of $\Gamma(p)$ gives rise to a connected $p$-divisible group.
\end{enumerate}
\end{ex}


\begin{rem}[]
	Even though the above is just a sketch of the construction, of which more details
	are available at \cite[\S6]{Shatz},
	we felt it was useful to quote it in view of the following section.
\end{rem}
\subsubsection{fppf sheaves point of view}
tk: here copy the relevant results from Messing.

In the following part we will always write groups over $S$, or $S$-group, to mean
an fppf sheaf of commutative groups on the site $(\mathsf{Sch}_{ S })_{\mathrm{fppf}}$.
\begin{lem}[{\cite[\S 1, lemma 1.1]{Messing}}]\label{lem:equivCondTruncatedBTGroup}
	The following conditions are equivalent:
\begin{enumerate}
	\item $G$ is a flat $\mathbb{Z}/p^n\mathbb{Z}$-module,

	\item $\ker(p^{n-i}) = \ima (p^i)$, for $i=0, \ldots, n$.
\end{enumerate}
\end{lem} 


\begin{defn}[Truncated Barsotti-Tate group of level $n$]
	Consider $n \geq 2$, a {\em truncated Barsotti-Tate group} of level $n$
	is an $S$-group $G$ such that
\begin{enumerate}
	\item $G$ is a finite and locally free group scheme.
	\item $G$ is killed by $p^n$ and satisfies the equivalent conditions of 
		\cref{lem:equivCondTruncatedBTGroup}.
\end{enumerate}
\end{defn}


\begin{defn}[]
	If $G$ is a group, we write $G(n)$ for the kernel of $p^n$.
	Then, if $G$ is killed by $p^n$, we write $G = G(n)$.
\end{defn}


\begin{lem}[{\cite[\S1, lemma 1.5]{Messing}}]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
	\item If $G(n)$ is a flat $\mathbb{Z}/p^n\mathbb{Z}$-module, then $G(n)$
		is a finite, locally-free group scheme iff
		$G(1)$ is. Then all the $G(i)$ are.

	\item If $G(n)$ is finite and locally free, then
		\begin{equation}
		\begin{tikzcd}[row sep = 0ex
			,/tikz/column 1/.append style={anchor=base east}
			,/tikz/column 2/.append style={anchor=base west}]
			p^i\colon G(n) \arrow[r, "", rightarrow] &
			G(n-1)
		\end{tikzcd}
		\end{equation} 
		is an epimorphism iff it is faithfully flat.
\end{enumerate}
\end{lem} 


\begin{defn}[$p$-torsion and $p$-divisible groups]
	Let $S$ be a scheme and $G$ be an $S$-group.
	Denote by $G(n)$ the kernel of the multiplication by $p^n$ on $G$.
	The group $G$ is said to be of {\em $p$-torsion} iff $\varprojlim_{n \in \mathbb{N}} G(n) = G$.
	Similarly $G$ is said to be {\em $p$-divisible} iff $p\colon G \to G$
	is an epimorphism.
\end{defn}


\begin{defn}[Barsotti-Tate group]\label{BTGroup}
	An $S$ group $G$ is called {\em Barsotti-Tate} iff it satisfies
\begin{enumerate}
	\item $G$ is of $p$-torsion,
	\item $G$ is $p$-divisible,
	\item $G(1)$ is a finite, locally-free group scheme.
\end{enumerate}
	We denote by $\mathsf{BT}_S$ the full subcategory of $\mathsf{Gr}_S$,
	whose objects are Barsotti-Tate groups over $S$.
\end{defn}


\begin{rem}[]
	The category $\mathsf{BT}_S$ is not abelian:
	it does not admit kernels.
	In fact the kernel of the morphism $p\colon G \to G$
	of multiplication by $p$ must be killed by $p$, hence cannot be
	a Barsotti-Tate group (unless $G=0$).
\end{rem}


\begin{rem}[Comparison of the two points of view]
	We will follow \cite[\S2, remark 2.3 and \S3, theorem 2.1.7]{Messing} to show that
	the two points of view define the same objects over $S = \mathrm{Spec}(R)$,
	for an admissible local ring $R$.
	Let's start by considering $G \in \mathsf{BT}_S$.
	Then, by definition, $G(v) = G(v+r)(v)$, i.e. denoted by $i_v\colon G(v) \to G(v+1)$
	the inclusion of $G(v)$ into $G(v+1)$, we obtain that 
	$\left( G_v, i_v \right)_{v \in \mathbb{N}}$ is an inductive system of $S$-groups.
	Moreover $G(v)$ is a kernel of multiplication by $p^v$ on $G_{v+t}$, for $t \geq 0$
	which, in particular, means that the following is exact.
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		G_v \arrow[r, "i_v", rightarrow] &
		G_{v+1} \arrow[r, "p^v", rightarrow] &
		G_{v+1}
	.\end{tikzcd}
	\end{equation*}
	Hence $\left( G_v, i_v \right)_{v \in \mathbb{N}}$ satisfies condition $2$
	of \cref{defn:pDivGroupFormalSchemes}.
	Then, since $G$ is $p$-divisible, i.e. multiplication by $p$ is an
	epimorphism of $G$, we have that for any $0 \leq i \leq n$
	$p^{n-i}$ induces an epimorphism $G(n) \twoheadrightarrow G(i)$.
	Combining this with the above remark we obtain the exactness of
	\begin{equation}\label{diag:equivpDivGrDefn}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		G(n-i) \arrow[r, "", rightarrow] &
		G(n) \arrow[r, "p^{n-i}", rightarrow] &
		G(i) \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation}
	From the theory of finite group schemes over a field one obtains that the
	rank of the fiber of $G(1)$ at a point $s \in S$ is of the form
	$p^{h(s)}$ for a function $h$ which is locally constant on $S$.
	Then, from \cref{diag:equivpDivGrDefn} and multiplicativity of
	ranks in short exact sequences, see \cref{QuotientGroupScheme}, we obtain
	that the rank of the fiber of $G(n)$ at $s$
	is $p^{n(s)}$.
	Hence our inductive system satisfies also $1$ 
	of \cref{defn:pDivGroupFormalSchemes}.

	Starting from a $p$-divisible group $\left( G_v, i_v \right)_{v \in \mathbb{N}}$,
	instead, we set $G \coloneqq \varinjlim_{v \in \mathbb{N}} G_v$
	and invoke \cref{CharactpDivGroups} to conclude that $G \in \mathsf{BT}_S$.
\end{rem}


Before moving on to the concept of duality for $p$-divisible groups
we'll state a result
which relate the concepts introduced in the last couple of sections:
that of formal Lie group and of $p$-divisible group.


\begin{prop}[{\cite[\S2, proposition 1]{TatePC}}]
	Let $R$ be a complete Noetherian local ring whose residue field $k$
	is of characteristic $p > 0$.
	Then the functor $\Gamma \mapsto \Gamma(p)$, constructed as in \cref{ConnectedpDivGroupFLG}
	of \cref{ex:pDivGroups},
	is an equivalence of categories
	between the category of $p$-divisible commutative formal Lie groups over $R$
	and the category of connected $p$-divisible groups over $R$.
\end{prop}



%\subsection{Cartier duality for \texorpdfstring{$p$}{p}-divisible groups}
%tk: add this section (or something like: Other properties) if you want to 
%also speak about dimension. Otherwise no point in doing it.
%
%
%In this section we want to extend the concept of duality introduced in \cref{CartierDualityGroups}.
%We will do so considering $p$-divisible groups as formal schemes,
%i.e. as inductive systems of finite commutative group schemes.
%In fact we will follow \cite[\S6]{Shatz} (or Tate? tk).



%\begin{defn}[Dimension of a $p$-divisible group]
%	Let $G \coloneqq \left(G_{\nu}, i_\nu\right)_{\nu \in \mathbb{N}}$ be a $p$-divisible group
%	over $R$ as before.
%	The connected components $G^0_\nu$ determine a connected $p$-divisible
%	group $G^0$.
%	Moreover, from the short exact sequence
%	\begin{equation*}
%	\begin{tikzcd}
%		0 \arrow[r, "", rightarrow] &
%		G^0_\nu \arrow[r, "", rightarrow] &
%		G_\nu \arrow[r, "", rightarrow] &
%		G^{et}_\nu \arrow[r, "", rightarrow] &
%		0
%	\end{tikzcd}
%	\end{equation*}
%	one gets the exact sequence
%	\begin{equation*}
%	\begin{tikzcd}
%		0 \arrow[r, "", rightarrow] &
%		G^0 \arrow[r, "", rightarrow] &
%		G \arrow[r, "", rightarrow] &
%		G^{et} \arrow[r, "", rightarrow] &
%		0
%	,\end{tikzcd}
%	\end{equation*}
%	where $G^{et}$ is an étale $p$-divisible group.
%	One then defines the dimension of $G$ to be the dimension 
%	(i.e. the number of variables of $\mathscr{A}$)
%	of the formal Lie group corresponding, as of proposition (tk: reference to the above one),
%	to $G^0$.
%\end{defn}


\end{document}
