\section{The crystals associated to Barsotti-Tate groups}
In this section we want to associate to certain Barsotti-Tate groups
a few crystals.
In order to do so we need to discuss universal extensions, which will be the basis
for the definitions of such crystals.



\subsection{Universal extensions}
Before studying the case of our interest, let's recall the necessary definitions
and notations.



\subsubsection{Extensions}
Here we will usually assume $\mathsf{C}$ to be in an abelian category on which
we can compute the $\mathrm{Ext}^n_{\mathsf{C}}$ functors.


\begin{defn}[Extension]
	Let $\mathsf{C}$ be an abelian category and $A,B \in \mathsf{C}$.
	We define an {\em extension} $X$ of $A$ by $B$ to be a short exact sequence
	\begin{equation*}
	\begin{tikzcd}
		(\zeta) &
		0 \arrow[r, "", rightarrow] &
		B \arrow[r, "", rightarrow] &
		X \arrow[r, "", rightarrow] &
		A \arrow[r, "", rightarrow] &
		0
	,\end{tikzcd}
	\end{equation*}
	where $X \in \mathsf{C}$.
	We might also denote the extension by $\zeta$.
	Moreover, given two extensions $\zeta$ and $\zeta'$ of $A$ by $B$,
	given by $X$ and $X'$, we say that a {\em morphism of extensions} of $A$ by $B$
	is a morphism $f\colon X \to X'$ that makes the following diagram commute
	\begin{equation*}
	\begin{tikzcd}
		(\zeta) &
		0 \arrow[r, "", rightarrow] &
		B \arrow[r, "", rightarrow] 
		\arrow[d, "", equals] &
		X \arrow[r, "", rightarrow] 
		\arrow[d, "f", rightarrow] &
		A \arrow[r, "", rightarrow] 
		\arrow[d, "", equals] &
		0\\
		(\zeta') &
		0 \arrow[r, "", rightarrow] &
		B \arrow[r, "", rightarrow] &
		X' \arrow[r, "", rightarrow] &
		A \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
	Finally we introduce the notation $\mathrm{E}(A,B)$ for the set of all extensions
	of $A$ by $B$, and the notation $\mathrm{Hom} \left( \zeta, \zeta' \right)$
	to denote the set of $f\colon X \to X'$ inducing a morphism of extensions.
\end{defn}


\begin{rem}[]
	Notice that, thanks to the five lemma, all $f \in \mathrm{Hom} 
	\left( \zeta, \zeta' \right)$ are isomorphisms in $\mathsf{C}$.
\end{rem}


\begin{defn}[Pullback and pushout]\leavevmode\vspace{-\baselineskip}
\begin{enumerate}
	\item Given a morphism $\gamma\colon A' \to A$ and an extension $X$
		of $A$ by $B$, we define $X' \coloneqq X \cross_A A'$,
		so that we have the following commutative diagram
		of short exact sequences
		\begin{equation*}
		\begin{tikzcd}
			(\zeta\gamma) &
			0 \arrow[r, "", rightarrow] &
			B \arrow[r, "", rightarrow] 
			\arrow[d, "", equals] &
			X' \arrow[r, "", rightarrow] 
			\arrow[d, "", rightarrow] &
			A' \arrow[r, "", rightarrow] 
			\arrow[d, "", rightarrow] &
			0\\
			(\zeta) &
			0 \arrow[r, "", rightarrow] &
			B \arrow[r, "", rightarrow] &
			X \arrow[r, "", rightarrow] &
			A \arrow[r, "", rightarrow] &
			0
		.\end{tikzcd}
		\end{equation*}
		The extension $X'$ of $A'$ by $B$
		is called the {\em pullback} of $X$ via $A' \to A$.
		Moreover, if we denote by $\zeta$ the extension
		$X$ of $A$ by $B$, then we denote by $\zeta\gamma$
		its pullback via $\gamma$.

	\item Given a morphism $\beta\colon B \to B'$ and an extension $X$
		of $A$ by $B$, we define $X' \coloneqq B' \amalg_A X$,
		so that we have the following commutative diagram
		of short exact sequences
		\begin{equation*}
		\begin{tikzcd}
			(\zeta) &
			0 \arrow[r, "", rightarrow] &
			B \arrow[r, "", rightarrow] 
			\arrow[d, "", rightarrow] &
			X \arrow[r, "", rightarrow] 
			\arrow[d, "", rightarrow] &
			A \arrow[r, "", rightarrow] 
			\arrow[d, "", equals] &
			0\\
			(\beta\zeta) &
			0 \arrow[r, "", rightarrow] &
			B' \arrow[r, "", rightarrow] &
			X' \arrow[r, "", rightarrow] &
			A \arrow[r, "", rightarrow] &
			0
		.\end{tikzcd}
		\end{equation*}
		The extension $X'$ of $A$ by $B'$
		is called the {\em pushout} of $X$ via $B \to B'$.
		Moreover, if we denote by $\zeta$ the extension
		$X$ of $A$ by $B$, then we denote by $\beta\zeta$
		its pushout via $\beta$.
\end{enumerate}
\end{defn}


\begin{rem}[]\label{rem:CorrExtAutMor}
	Given an extension
	\begin{equation*}
	\begin{tikzcd}
		(\zeta) &
		0 \arrow[r, "", rightarrow] &
		M \arrow[r, "\iota", rightarrow] &
		E \arrow[r, "\pi", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	,\end{tikzcd}
	\end{equation*}
	we can construct an isomorphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\mathrm{Hom}_{\mathsf{Gr}_S} \left( G, M \right)
		\arrow[r, "\sim", rightarrow] &
		\mathrm{Aut}(\zeta) \\
		u \arrow[r, "", mapsto] & 
		\mathrm{id}_{ E } + \iota \circ u \circ \pi
	,\end{tikzcd}
	\end{equation*} 
	where we denoted by $\mathrm{Aut}(\zeta) \coloneqq \mathrm{Hom} \left( \zeta, \zeta \right)$.
	The construction of the inverse morphism follows naturally from the 
	universal properties of kernel and cokernel, since $M = \ker \pi$
	and $G = \coker \iota$.
\end{rem}


\begin{rem}[]\label{rem:YonedaExensionTheta}
	We define an equivalence relation on the set $\mathrm{E}(A,B)$ by
	saying that $\zeta \sim \zeta'$ 
	iff $\mathrm{Hom}_{  } \left( \zeta, \zeta' \right) \neq 0$,
	i.e. iff there is a commutative diagram
	\begin{equation*}
	\begin{tikzcd}
		(\zeta) &
		0 \arrow[r, "", rightarrow] &
		B \arrow[r, "", rightarrow] 
		\arrow[d, "", equals] &
		X \arrow[r, "", rightarrow] 
		\arrow[d, "\rotatebox{90}{\(\sim\)}", rightarrow] &
		A \arrow[r, "", rightarrow] 
		\arrow[d, "", equals] &
		0\\
		(\zeta') &
		0 \arrow[r, "", rightarrow] &
		B \arrow[r, "", rightarrow] &
		X' \arrow[r, "", rightarrow] &
		A \arrow[r, "", rightarrow] &
		0
	\end{tikzcd}
	\end{equation*}
	connecting the two extensions.
	Assume now that we can compute $\mathrm{Ext}^n_{\mathsf{C}}(A, B)$
	for all $A,B \in \mathsf{C}$ and all $n \in \mathbb{N}$.
	Then we can define a map $\theta\colon \mathrm{E}(A,B) \to 
	\mathrm{Ext}^1_{\mathsf{C}}(A,B)$ as follows.
	Fix an extension $\zeta \in \mathrm{E}(A,B)$, given by $X$,
	and denote by $h^B$ the Yoneda
	embedding defined, for all $X \in \mathsf{C}$, by
	$h^B(X) \coloneqq \mathrm{Hom}_{\mathsf{C}} \left( X, B \right)$.
	We apply the right derived functor 
	$\left\{ R^n h^B \right\}_{n \in \mathbb{N}}$ of $h^B$, 
	to the short exact sequence
	\begin{equation*}
	\begin{tikzcd}
		(\zeta) &
		0 \arrow[r, "", rightarrow] &
		B \arrow[r, "", rightarrow] &
		X \arrow[r, "", rightarrow] &
		A \arrow[r, "", rightarrow] &
		0
	,\end{tikzcd}
	\end{equation*}
	induced by the extension $\zeta$.
	This gives rise to a long exact sequence
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{C}} \left( A, B \right) \arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{C}} \left( X, V \right) \arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{C}} \left( B, B \right) \arrow[r, "\partial", rightarrow] &
		\mathrm{Ext}^1_{\mathsf{C}}(A,B)
	.\end{tikzcd}
	\end{equation*}
	Here we define $\theta(\zeta) \coloneqq \partial(\mathrm{id}_{ B }) \in \mathrm{Ext}^1_{\mathsf{C}}
	(A,B)$.
\end{rem}


\begin{lem}[{\cite[\S3.4, Porism 3.4.2]{Weibel}}]
	Let $\mathsf{C}$ be an abelian category on which we
	can compute $\mathrm{Ext}^n_{\mathsf{C}}(A,B)$
	for all $A, B \in \mathsf{C}$ and all $n \in \mathbb{N}$.
	Let $\zeta \sim \zeta'$ be equivalent extensions of
	$A$ by $B$.
	Then $\theta(\zeta) = \theta(\zeta')$, hence $\theta$
	defines a map
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\theta\colon \displaystyle{\frac{\mathrm{E}(A,B)}{\sim}} 
		\arrow[r, "", rightarrow] &
		\mathrm{Ext}^1_{\mathsf{C}}(A,B)
	.\end{tikzcd}
	\end{equation*} 
\end{lem} 


\begin{thm}[{\cite[\S3.4, Thoerem 3.4.3]{Weibel}}]\label{thm:CorrExt}
	Let $\mathsf{C}$ be an abelian category on which we
	can compute $\mathrm{Ext}^n_{\mathsf{C}}(A,B)$
	for all $A, B \in \mathsf{C}$ and all $n \in \mathbb{N}$.
	Then $\theta$ induces a bijective correspondence
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\displaystyle{\frac{\mathrm{E}(A,B)}{\sim}} 
		\arrow[r, "\theta", leftrightarrow] &
		\mathrm{Ext}^1_{\mathsf{C}}(A,B)
	.\end{tikzcd}
	\end{equation*} 
\end{thm} 



\subsubsection{Universal extensions}
For this section we fix $S$ a scheme and $G$ a finite locally-free $S$-group.
For the first proposition it is not necessary, but for the rest of the section we will often
assume that $p^N$ is zero on $S$.
Here, thanks to \cref{rem:PropertiesGrS},
we will apply the results of last section to $\mathsf{Gr}_S$.


\begin{prop}[{\cite[Chapter IV, proposition 1.3]{Messing}}]\label{prop:ReprhM}
	The functor acting, on quasi-coherent $\mathcal{O}_{ S }$-modules, by
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\mathcal{M} \arrow[r, "", mapsto] & 
		\mathrm{Hom}_{ \mathsf{Gr}_S } \left( G, \underline{\mathcal{M}} \right)
	\end{tikzcd}
	\end{equation*} 
	is represented by $\underline{\omega}_{G^\vee}$, where $G^\vee$ is
	the Cartier dual of $G$.
\end{prop}


\begin{rem}[]\label{rem:ReprMorExt}
	The proposition implies that there is
	a homomorphism $\alpha\colon G \to \underline{\omega}_{G^\vee}$
	with the property that, for all $\beta\colon G \to \underline{\mathcal{M}}$,
	there is a unique linear $u\colon \underline{\omega}_{G^\vee} \to \underline{\mathcal{M}}$
	such that $\beta = u \circ \alpha$.
	Moreover, following {\cite[Chapter IV, remark 1.6]{Messing}},
	one can check that the isomorphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\mathrm{Hom}_{\mathsf{Gr}_S} \left( G, \underline{\mathcal{M}} \right)
		\arrow[r, "\sim", rightarrow] &
		\mathrm{Hom}_{\mathsf{Gr}_S} \left( \underline{\omega}_{G^\vee}, \underline{\mathcal{M}} \right)
	\end{tikzcd}
	\end{equation*} 
	is functorial in $G$.
	Thus, given a morphism of finite locally-free $S$-groups $u\colon G \to H$,
	we have a commutative diagram whose lower horizontal arrow is
	induced by the Cartier dual of $u$
	\begin{equation}\label{diag:functorialityRepresent}
	\begin{tikzcd}
		G \arrow[r, "u", rightarrow] 
		\arrow[d, "\alpha_G"', rightarrow] &
		H \arrow[d, "\alpha_H", rightarrow] \\
		\underline{\omega}_{G^\vee} \arrow[r, "", rightarrow] &
		\underline{\omega}_{H^\vee}
	.\end{tikzcd}
	\end{equation}
\end{rem}
%tk: decide whether to add also remark 1.5 page 117 of Messing.
%As of now, nope


\begin{lem}\label{lem:rigidityExt}
	Let $S$ be a scheme killed by $p^N$, $G$ a Barsotti-Tate group on $S$
	and $\mathcal{M}$ a quasi-coherent $\mathcal{O}_S$-module.
	Then any extension $\zeta$ of $G$ by $\underline{\mathcal{M}}$ is
	uniquely determined by $\theta(\zeta) \in 
	\mathrm{Ext}^1_{\mathsf{Gr}_S}(G, \underline{\mathcal{M}})$.
\end{lem} 
\begin{proof}
	Since $p^N$ kills $S$, multiplication by $p^N$ 
	is the trivial map on $\mathcal{M}$.
	As a consequence, for all $f \in \mathrm{Hom}_{\mathsf{Gr}_S}
	\left( G, \underline{\mathcal{M}} \right)$,
	we obtain the following commutative diagram
	\begin{equation*}
	\begin{tikzcd}
		G \arrow[r, "f", rightarrow] 
		\arrow[d, "p^N"', rightarrow] 
		\arrow[rd, "0", rightarrow] &
		\underline{\mathcal{M}} \arrow[d, "p^n", rightarrow] \\
		G \arrow[r, "f"', rightarrow] &
		\underline{\mathcal{M}}
	.\end{tikzcd}
	\end{equation*}
	But this means that $f \circ p^N = 0$ and, since multiplication
	by $p^N$ on $G$ is an epimorphism, that $f = 0$.
	This proves that $\mathrm{Hom}_{ \mathsf{Gr}_S } \left( G, \underline{\mathcal{M}} \right) = 0$.
	Thanks to \cref{rem:CorrExtAutMor}, this implies that
	the only automorphism of $\zeta$ is the identity.
	Let's now recall \cref{rem:PropertiesGrS},
	which states that $\mathsf{Gr}_S$ is an abelian category with enough injectives.
	This allows us to apply \cref{thm:CorrExt}.
	Then the above implies that $\zeta$ is uniquely determined by $\theta(\zeta)
	\in \mathrm{Ext}^1_{\mathsf{Gr}_S}(G, \underline{\mathcal{M}})$,
	since its equivalence class is reduced to $\zeta$ itself.
\end{proof}


\begin{defn}[Universal extension]
	Let $S$ be a scheme, $G \in \mathsf{BT}(S)$
	and $\underline{V}(G)$ a vector $S$-group.
	We say that an extension $\zeta \in \mathrm{E}(G, \underline{V}(G))$, given
	by $E(G)$, is {\em universal} iff, given any extension
	\begin{equation*}
	\begin{tikzcd}
		(\xi) &
		0 \arrow[r, "", rightarrow] &
		\underline{\mathcal{M}} \arrow[r, "", rightarrow] &
		(*) \arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	\end{tikzcd}
	\end{equation*}
	of $G$ by $\underline{\mathcal{M}}$, where $\mathcal{M}$ is a quasi-coherent
	$\mathcal{O}_{ S }$-module,
	there is a unique map $\varphi\colon \underline{V}(G) \to \underline{\mathcal{M}}$
	such that $\varphi\zeta = \xi$, i.e.
	the pushout of $E(G)$ by $\varphi$ is the given
	extension $\xi$.
\end{defn}


\begin{rem}[]
	Let's consider again the case where $p$ is 
	nilpotent on the base scheme $S$.
	By rigidity of extensions of Barsotti-Tate groups
	by quasi-coherent modules, i.e. \cref{lem:rigidityExt}, 
	we see that $\varphi\zeta = \xi$ is
	actually an equality, and not just an isomorphism.
\end{rem}


\begin{prop}[]
	Let $S$ be a scheme killed by $p^N$ and $G$
	a Barsotti-Tate group on $S$.
	Then there is a universal extension of $G$ by a vector group,
	which we denote by
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\underline{V}(G) \arrow[r, "", rightarrow] &
		E(G) \arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
\end{prop}
\begin{proof}
	Let's start by noticing that we are in the same situation
	of \cref{lem:rigidityExt}.
	Consider now the short exact sequence
	\begin{equation*}
	\begin{tikzcd}
		(\zeta') &
		0 \arrow[r, "", rightarrow] &
		G(N) \arrow[r, "\iota_G", rightarrow] &
		G \arrow[r, "p^N", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
	Let's fix a quasi-coherent $\mathcal{O}_{ S }$-module $\mathcal{M}$.
	Applying, as in \cref{rem:YonedaExensionTheta}, the right derived functor
	$\left\{ R^n h^{\underline{\mathcal{M}}} \right\}_{n \in \mathbb{N}}$, we obtain the long exact sequence
	\begin{equation*}
	\begin{tikzcd}%[column sep=0.60em]
		0 \arrow[r, "", rightarrow] &
		%\mathrm{Hom}%_{\mathsf{Gr}_S} 
		%\left( G, \underline{\mathcal{M}} \right)
		%\arrow[r, "", rightarrow] &
		%\mathrm{Hom}%_{\mathsf{Gr}_S} 
		%\left( G, \underline{\mathcal{M}} \right) 
		%\arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{Gr}_S} 
		\left( G(N), \underline{\mathcal{M}} \right) 
		\arrow[r, "\partial", rightarrow] &
		\mathrm{Ext}^1_{\mathsf{Gr}_S}
		(G,\underline{\mathcal{M}})
		\arrow[r, "p^N", rightarrow] &
		\mathrm{Ext}^1_{\mathsf{Gr}_S}
		(G,\underline{\mathcal{M}})
	,\end{tikzcd}
	\end{equation*}
	where we used $\mathrm{Hom}_{\mathsf{Gr}_S} \left( G, \underline{\mathcal{M}} \right) = 0$,
	as seen in \cref{lem:rigidityExt}.
	Moreover $\mathrm{Ext}^1$ is a bifunctor, which implies that
	the map $p^N\colon \mathrm{Ext}^1_{\mathsf{Gr}_S}(G,\underline{\mathcal{M}})
	\to \mathrm{Ext}^1_{\mathsf{Gr}_S}(G,\underline{\mathcal{M}})$ comes from multiplication
	by $p^N$ in $\underline{\mathcal{M}}$. 
	Hence, by additivity of $\mathrm{Ext}$, it is $0$.
	This implies that $\partial$ is an isomorphism.
	Clearly this argument is functorial in $\underline{\mathcal{M}}$.
	Moreover, by \cref{prop:ReprhM}, we see that 
	the source of $\partial$ is represented by $\underline{\omega}_{G(N)^\vee}$.
	Let $\alpha\colon G(N) \to \underline{\omega}_{G(N)^\vee}$
	be as in \cref{rem:ReprMorExt} and define $\zeta \coloneqq \alpha\zeta'$,
	as in the following commutative diagram
	\begin{equation*}
	\begin{tikzcd}
		(\zeta') &
		0 \arrow[r, "", rightarrow] &
		G(N) \arrow[r, "\iota_G", rightarrow] 
		\arrow[d, "\alpha", rightarrow] &
		G \arrow[r, "p^N", rightarrow] 
		\arrow[d, "", rightarrow] &
		G \arrow[r, "", rightarrow] 
		\arrow[d, "", equals] &
		0\\
		(\alpha\zeta') &
		0 \arrow[r, "", rightarrow] &
		\underline{\omega}_{G(N)^\vee} 
		\arrow[r, "", rightarrow] &
		%\underline{\omega}_{G(N)^\vee} \coprod_{G(N)} G
		E(G)
		\arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	,\end{tikzcd}
	\end{equation*}
	where we denoted by $E(G) \coloneqq \underline{\omega}_{G(N)^\vee} \amalg_{G(N)} G$.
	Then, by rigidity of extensions of $G$ by vector groups, i.e. 
	\cref{lem:rigidityExt}, any extension $\xi$ of $G$ by a
	vector group is uniquely determined by its
	class $\theta(\xi) \in \mathrm{Ext}^1_{\mathsf{Gr}_S}(G, \underline{\mathcal{M}})$.
	By the above this corresponds to a morphism $u\colon G(N) \to \underline{\mathcal{M}}$
	which, thanks to \cref{rem:ReprMorExt},
	factors through $\alpha$ as $u = \alpha \circ \beta$.
	Finally, thanks to naturality of the connecting morphism $\partial$, 
	we obtain the following commutative diagram, obtained from the
	pushout of the extension $\zeta$ via $\beta$:
	\begin{equation*}
	\begin{tikzcd}%[column sep=0.70em]
		0 \arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{Gr}_S} 
		\left( P, \underline{\mathcal{M}} \right) 
		\arrow[d, "", rightarrow] 
		\arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{Gr}_S} 
		\left( \underline{\mathcal{M}}, \underline{\mathcal{M}} \right) 
		\arrow[d, "{\mathrm{Hom}_{\mathsf{Gr}_S} 
		\left( \ \cdot \ , \beta \right)}", rightarrow] 
		\arrow[r, "\partial_1", rightarrow] &
		\mathrm{Ext}^1_{\mathsf{Gr}_S}
		(G,\underline{\mathcal{M}})
		\arrow[d, "", equals] \\
		0 \arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{Gr}_S} 
		\left( E(G), \underline{\mathcal{M}} \right) 
		\arrow[d, "", rightarrow] 
		\arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{Gr}_S} 
		\big( \underline{\omega}_{G(N)^\vee}, \underline{\mathcal{M}} \big) 
		\arrow[d, "{\mathrm{Hom}_{\mathsf{Gr}_S} 
		\left( \ \cdot \ , \alpha\right)}", rightarrow] 
		\arrow[r, "\partial_2", rightarrow] &
		\mathrm{Ext}^1_{\mathsf{Gr}_S}
		(G,\underline{\mathcal{M}}) 
		\arrow[d, "", equals] \\
		0 \arrow[r, "", rightarrow] &
		0
		\arrow[r, "", rightarrow] &
		\mathrm{Hom}_{\mathsf{Gr}_S} 
		\left( G(N), \underline{\mathcal{M}} \right) 
		\arrow[r, "\partial_3", rightarrow] &
		\mathrm{Ext}^1_{\mathsf{Gr}_S}
		(G,\underline{\mathcal{M}})
	,\end{tikzcd}
	\end{equation*}
	where the extension $\beta\zeta$ of $G$ by $\underline{\mathcal{M}}$ is given by $P$.
	By definition of $\theta$ the rightmost rectangle acts on elements as
	\begin{equation*}
	\begin{tikzcd}
		\mathrm{id}_{ \underline{\mathcal{M}} }
		\arrow[r, "\partial_1", mapsto] 
		\arrow[d, "\beta^* \circ \alpha^*"', mapsto] &
		\theta(\beta\zeta)
		\arrow[d, "", equal] \\
		%\beta
		%\arrow[d, "\alpha^*", mapsto] 
		%& \\
		u \arrow[r, "\partial_3", mapsto] &
		\theta(\xi)
	.\end{tikzcd}
	\end{equation*}
	Commutativity of this diagram implies that $\theta(\beta\zeta) = \theta(\xi)$.
	Then rigidity of the extensions grants that $\xi = \beta\zeta$, i.e.
	that $\zeta$ is universal.
\end{proof}


\begin{rem}[{\cite[Chapter III, remark 1.11]{Messing}}]
	Notice that in the above proposition one could substitute
	$N$ with any $n \geq N$ and still obtain a universal extension.
	The unique isomorphism comes from the commutative diagram
	of \cref{diag:functorialityRepresent}
	which, setting $H = G(N)$ and $G = G(N+i)$, becomes
	\begin{equation*}
	\begin{tikzcd}
		G(N+i) \arrow[r, "p^i", rightarrow] 
		\arrow[d, "\alpha_{G(N+i)}"', rightarrow] &
		G(N) \arrow[d, "\alpha_{G(N)}", rightarrow] \\
		\underline{\omega}_{G(N+i)^\vee} \arrow[r, "\sim", rightarrow] &
		\underline{\omega}_{G(N)^\vee}
	.\end{tikzcd}
	\end{equation*}
	Here the fact that the bottom arrow is an isomorphism
	is \cref{rem:ConormalSheafBT}.
	Then, thanks to universal property of pushout it's easy to construct
	a morphism of extensions, which is clearly an isomorphism
	thanks to the five lemma.
\end{rem}


\begin{defn}[]
	Given $S$ and $G$ as before, for $n$ sufficiently big, we define
	$\underline{V}(G) \coloneqq \underline{\omega}_{G(n)^\vee}$ and
	$E(G) \coloneqq \underline{V}(G) \amalg_{G(n)} G$.
	Then the extension
	\begin{equation*}
	\begin{tikzcd}
		(\zeta) &
		0 \arrow[r, "", rightarrow] &
		\underline{V}(G) \arrow[r, "", rightarrow] &
		E(G) \arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	\end{tikzcd}
	\end{equation*}
	is universal.
	Moreover $E(G)$ is an fppf sheaf of groups on $S$,
	determined up to unique isomorphism.
\end{defn}


\noindent
Now that we have finally defined it, let's see
a few results concerned this universal extension.


\begin{lem}[{\cite[Chapter IV, lemma 1.13]{Messing}}]
	The universal extension 
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\underline{V}(G) \arrow[r, "", rightarrow] &
		E(G) \arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	\end{tikzcd}
	\end{equation*}
	commutes with base change.
\end{lem} 


\begin{lem}[{\cite[Chapter IV, corollary 1.14]{Messing}}]
	Assume that $p$ is only locally nilpotent on $S$
	and consider $G$ a Barsotti-Tate group on $S$.
	Then there is a universal extension, which we denote by
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\underline{V}(G) \arrow[r, "", rightarrow] &
		E(G) \arrow[r, "", rightarrow] &
		G \arrow[r, "", rightarrow] &
		0
	,\end{tikzcd}
	\end{equation*}
	of $G$ by the vector group
	$\underline{V}(G) \coloneqq \underline{\omega}_{G^\vee}$.
\end{lem} 


\begin{prop}[{\cite[Chapter IV, proposition 1.15]{Messing}}]\label{prop:MorUnivExts}
	Let $p$ be locally nilpotent on $S$ and $G,H$ be two
	Barsotti-Tate groups on $S$, with a homomorphism $u\colon G \to H$.
	Then there is a unique homomorphism
	$E(u)\colon E(G) \to E(H)$ inducing the morphism of extensions
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\underline{V}(G) \arrow[r, "", rightarrow] 
		\arrow[d, "\underline{V}(u)", rightarrow] &
		E(G) \arrow[r, "", rightarrow] 
		\arrow[d, "E(u)", rightarrow] &
		G \arrow[r, "", rightarrow] 
		\arrow[d, "u", rightarrow] &
		0\\
		0 \arrow[r, "", rightarrow] &
		\underline{V}(H) \arrow[r, "", rightarrow] &
		E(H) \arrow[r, "", rightarrow] &
		H \arrow[r, "", rightarrow] &
		0
	,\end{tikzcd}
	\end{equation*}
	where $\underline{V}(u)$ is induced by the Cartier dual of $u$.
\end{prop} 


\noindent
Recall that, in \cref{not:GBar}, we introduced the notation
$\overline{G} \coloneqq \varinjlim_{k \in \mathbb{N}} \mathrm{Inf}^k(G)$,
for $G \in \mathsf{Gr}_S$.


\begin{prop}[{\cite[Chapter IV, proposition 1.19]{Messing}}]\label{prop:ExtFLG}
	Let $G \in \mathsf{BT}(S)$ and $S$ be as before,
	then $\overline{E(G)}$ is a {\em formal Lie group}.
\end{prop} 


\begin{defn}[]
	Let $S$ be a scheme where $p$ is locally nilpotent and $G$
	a Barsotti-Tate group on $S$.
	Denote by $E(G)$ the universal extension of $G$, then we define
	$\mathrm{Lie}(E(G)) \coloneqq \mathrm{Lie}(\overline{E(G)})$.
\end{defn}


\begin{rem}[]
	Notice than $\mathrm{Lie}(E(G))$ is a locally-free
	$\mathcal{O}_{ S }$-module of finite rank.
	%If moreover $p^N$ kills $S$, we know that this actually coincides
	%with $\underline{\mathrm{Lie}}(E(G) \cross_{ G } G(N))$.
\end{rem}


\noindent
Let's end with a couple of results, still with the same notation and hypothesis as before.
\begin{prop}[{\cite[Chapter IV, proposition 1.21]{Messing}}]
	The following sequence is exact
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\overline{\underline{V}(G)} \arrow[r, "", rightarrow] &
		\overline{E(G)} \arrow[r, "", rightarrow] &
		\overline{G} \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
\end{prop} 


\begin{prop}[{\cite[Chapter IV, proposition 1.22]{Messing}}]
	The following sequence is exact
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\underline{V}(G) \arrow[r, "", rightarrow] &
		\underline{\mathrm{Lie}}(E(G)) \arrow[r, "", rightarrow] &
		\underline{\mathrm{Lie}}(G) \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
\end{prop} 



\subsection{Crystals associated to Barsotti-Tate groups}
Here we can finally use those results to define the desired crystals
associated to Barsotti-Tate groups.
Since it will be used quite a lot in what follows,
we introduce the following notation.


\begin{ntt}
	Let $S$ be a scheme and $\mathcal{I}$ be a quasi-coherent sheaf of
	ideals of $\mathcal{O}_{ S }$.
	We write $\mathbb{V}(\mathcal{I})$ to denote the unique
	closed subscheme of $S$ induced by the sheaf of ideals $\mathcal{I}$.
	Notice that, in the affine case $S = \mathrm{Spec}(A)$,
	the sheaf $\mathcal{I}$ corresponds to an ideal $I \triangleleft A$
	and $\mathbb{V}(I) \simeq \mathrm{Spec}(A/I)$.
\end{ntt} 


\begin{defn}[Locally infinitesimally liftable Barsotti-Tate groups]\label{defn:LILBTG}
	Let $S_0$ be a scheme with $p$ locally nilpotent on it.
	We denote by $\mathsf{BT}'(S_0) \subset \mathsf{BT}(S_0)$ 
	the full subcategory whose objects satisfy the following property:
	$G_0$ is in $\mathsf{BT}'(S_0)$ iff
	there is an affine open cover $\left\{ U_i \right\}_{i \in I}$ of $S_0$, which depends on $G_0$, 
	on which, for all $i$ and all finite order thickening $U_i \hookrightarrow U$,
	there is a $G \in \mathsf{BT}(U)$ such that
	$\left.G\right|_{U_i} = \left.G_0\right|_{U_i}$.
	We call the Barsotti-Tate groups in $\mathsf{BT}'(S_0)$
	{\em locally infinitesimally liftable}.
\end{defn}


\begin{rem}[]\label{rem:LocallyLiftableBTG}
	Quoting \cite{Messing} in the introduction to his work, it has been shown
	that the requirements in the above definition are always satisfied by 
	all objects $G_0 \in \mathsf{BT}(S_0)$.
	This allows to apply the following results in the most general case,
	without imposing any additional requirement on the chosen Barsotti-Tate group.
	(tk: should I keep notation as in Messing, or should I change it to reflect this remark?)	
	You should change it...
\end{rem}



\begin{thm}[{\cite[Chapter IV, theorem 2.2]{Messing}}]\label{thm:UniqueLiftingCrystals}
	Let $S = \mathrm{Spec}(A)$ such that $p^N \cdot 1_S = 0$,
	$S_0 \coloneqq \mathbb{V}(I) \subset S$, where $I$ is
	an ideal of $A$ with nilpotent divided powers.
	Let $G, H \in \mathsf{BT}(S)$ and consider a homomorphism
	$u_0\colon G_0 \to H_0$ between the respective restrictions to $S_0$.
	By \cref{prop:MorUnivExts} $u_0$ defines
	a morphism of extensions $v_0 \coloneqq E(u_0)\colon E(G_0) \to E(H_0)$,
	making the diagram commute:
	\begin{equation*}
	\begin{tikzcd}
		0 \arrow[r, "", rightarrow] &
		\underline{V}(G_0) \arrow[d, "\underline{V}(u_0)", rightarrow] 
		\arrow[r, "", rightarrow] &
		E(G_0) \arrow[d, "v_0", rightarrow]
		\arrow[r, "", rightarrow] &
		G_0 \arrow[d, "u_0", rightarrow]
		\arrow[r, "", rightarrow] &
		0 \\
		0 \arrow[r, "", rightarrow] &
		\underline{V}(H_0) \arrow[r, "", rightarrow] &
		E(H_0) \arrow[r, "", rightarrow] &
		H_0 \arrow[r, "", rightarrow] &
		0
	.\end{tikzcd}
	\end{equation*}
	Then there is a unique morphism of $S$-groups
	$v\colon E(G) \to E(H)$, which is not necessarily a morphism
	of extensions, that satisfies the following properties.
\begin{enumerate}
	\item $v$ is a lifting of $v_0$.

	\item Denote the inclusions by $i\colon \underline{V}(H) \to E(H)$ and by 
		$j\colon \underline{V}(G) \to E(G)$.
		Given $w\colon \underline{V}(G) \to \underline{V}(H)$ a lifting of $\underline{V}(u_0)$
		such that $d\coloneqq (i \circ w - v \circ j)\colon \underline{V}(G) \to E(H)$
		induces the zero morphism on $S_0$, then $d$ is an exponential.
		%(tk: the definition of exponential for BT groups is given in III 2.4,
		%think about whether its better to tex it or not.)
\end{enumerate}
\end{thm}


\begin{rem}[{\cite[Chapter IV, remark 2.3]{Messing}}]
	The morphism $v$ is independent of the choice of $w$
	in \cref{thm:UniqueLiftingCrystals}.
	In fact, chosen another lift $w'$ of $\underline{V}(u_0)$, we 
	can write $w' = w + h$, where $h$, thanks to \cref{lem:CongruentLinComp}
	is an exponential.
	So, defining $d'$ corresponding to $w'$ in the
	above construction, we obtain $d' = d + i \circ h$.
	But then it is easy to show that $i \circ h$ is
	itself an exponential, hence that $d'$ is an
	exponential iff $d$ is.
\end{rem}


\begin{cor}[{\cite[Chapter IV, corollary 2.4.1]{Messing}}]\label{thm:M4.2.4.1}
	Let $G, H, K \in \mathsf{BT}(S)$ as before and consider another
	homomorphism $u_0'\colon H_0 \to K_0$, where $K_0$ again denotes
	the restriction of $K$ to $S_0$.
	Denote by $E_S(u_0)$ the morphism $v$ whose existence is granted in
	\cref{thm:UniqueLiftingCrystals}.
	Then $E_S(u'_0 \circ u_0) = E_S(u'_0) \circ E_S(u_0)$.
\end{cor} 


\begin{cor}[{\cite[Chapter IV, corollary 2.4.2]{Messing}}]\label{thm:M4.2.4.2}
	If, in the above notation, $G = H$ and $u_0 = \mathrm{id}_{ G_0 }$,
	then $E_S(u_0) = \mathrm{id}_{ G }$.
\end{cor} 


\begin{cor}[{\cite[Chapter IV, corollary 2.4.3]{Messing}}]\label{thm:M4.2.4.3}
	Let $G,H, u_0$ as in \cref{thm:UniqueLiftingCrystals},
	with $u_0$ an isomorphism.
	Then $E_S(u_0)$ is an isomorphism too.
\end{cor} 


\begin{cor}[{\cite[Chapter IV, corollary 2.4.4]{Messing}}]\label{thm:M4.2.4.4}
	Suppose we are given a commutative diagram
	\begin{equation*}
	\begin{tikzcd}
		S_0 \arrow[r, "", hookrightarrow] &
		S \\
		S_0' \arrow[u, "", rightarrow] 
		\arrow[r, "", hookrightarrow] &
		S' \arrow[u, "", rightarrow] 
	,\end{tikzcd}
	\end{equation*}
	where $S_0 \hookrightarrow S$ and $S'_0 \hookrightarrow S'$ are
	nilpotent immersion as in the statement of \cref{thm:UniqueLiftingCrystals}.
	Write $S_0' = \mathbb{V}(J)$ and $S_0 = \mathbb{V}(I)$
	and assume that $S' \to S$ is a divided powers morphism.
	Consider $G,H \in \mathsf{BT}(S)$ and $u_0\colon G_0 \to H_0$ as before.
	Then the construction of $E_S(u_0)$ is compatible with the base
	change $S' \to S$.
	More explicitly we have
	\begin{equation*}
		E_{S'}(u_{0_{S'_0}}) =
		\left( E_S(u_0) \right)_{S'} = v_{S'}
	.\end{equation*}
\end{cor} 


\noindent
Thanks to the above results we are ready to define the crystals we hinted at above.


\begin{rem}[{\cite[Chapter IV, \S2.5]{Messing}}]\label{CrystalLocalPB}
	Let $S_0$ be a scheme with $p$ locally
	nilpotent on it and $G \in \mathsf{BT}'(S_0)$.
	Let's start by recalling that, since crystals are sheaves on $\mathsf{Crys}(X)$,
	it suffices to define them locally.
	More specifically we are going to define their evaluation
	on objects $\left(U_0 \hookrightarrow U, \delta\right) \in \mathsf{Crys}(S_0)$
	with the property that $U_0$ is affine with $p$ nilpotent on $U_0$ and
	$\left.G_0\right|_{U_0}$ can be lifted to $U$.

	Moreover, by \cref{thm:M4.2.4.1,thm:M4.2.4.2,thm:M4.2.4.3},
	we can see that, fixing one such object of $\mathsf{Crys}(S_0)$,
	$E(G)$ is independent of the chosen lift of $\left.G_0\right|_{U_0}$.
	Also, given 
	$f\colon \left(V_0 \hookrightarrow V, \delta\right) \to 
	\left(U_0 \hookrightarrow U, \gamma\right)$,
	a morphism in $\mathsf{Crys}(S_0)$
	inducing the diagram
	\begin{equation*}
	\begin{tikzcd}
		U_0 \arrow[r, "", hookrightarrow] &
		U\\
		V_0 \arrow[u, "f", rightarrow] 
		\arrow[r, "", hookrightarrow] &
		V \arrow[u, "\overline{f}"', rightarrow] 
	,\end{tikzcd}
	\end{equation*}
	then $f$ is an open immersion.
	Hence $u_0\colon f^* \left.G_0\right|_{U_0} \to \left.G_0\right|_{V_0}$
	is an isomorphism. 
	Then, applying \cref{thm:M4.2.4.3} to $G_U$ a lift of
	$\left.G_0\right|_{U_0}$ to $U$ and $G_V$ of $\left.G_0\right|_{V_0}$ to $V$,
	we obtain a canonical isomorphism
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\overline{f}^* \left( E(G_U) \right) \arrow[r, "\sim", rightarrow] &
		E(G_V)
	.\end{tikzcd}
	\end{equation*} 
\end{rem}


\begin{defn}[]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
\item In the above notation, we define the crystal $\mathbb{E}(G_0)$
	by setting its value on $\left(U_0 \hookrightarrow U, \delta\right)$, as considered
	before, to be $E(G)$ for any lifting of $\left.G_0\right|_{U_0}$.

\item In the same way we define, for any morphism $u_0\colon G_0 \to H_0$ of 
	Barsotti-Tate groups on $S_0$, a morphism of associated crystals.
	In particular, on "sufficiently
	small" open subsets $U_0 \hookrightarrow U$ as before,
	we set $\mathbb{E}(u_0) \coloneqq E(u_0)$.

\item Finally, for an arbitrary morphism of schemes $f\colon T_0 \to S_0$,
	we can define the {\em pullback} of the crystal $\mathbb{E}(G_0)$, denoted
	by $f^* \left( \mathbb{E}(G_0) \right)$, on "sufficiently small" open
	sets in the crystalline site of $T_0$.
	Here we say that $V_0 \hookrightarrow V$ is sufficiently small iff
\begin{enumerate}
	\item $f(V_0) \subset U_0$ and $\left.G_0\right|_{U_0}$ can be lifted to infinitesimal
		neighbourhoods,

	\item $V_0$ is affine.
\end{enumerate}
\end{enumerate}
\end{defn}


\begin{rem}[{\cite[Chapter IV, \S2.5]{Messing}}]
	Since we are in the affine case we can use the construction of amalgamated
	sum of schemes to obtain the diagram
	\begin{equation*}
	\begin{tikzcd}[/tikz/column 2/.append style={anchor=base west}]
		U_0 \arrow[r, "", hookrightarrow] &
		U \coloneqq U_0 \amalg_{V_0} V \\
		V_0 \arrow[u, "f", rightarrow] 
		\arrow[r, "", hookrightarrow] &
		V \arrow[u, "", rightarrow, end anchor={[xshift=1.84ex,yshift=0.29ex]south west},
		start anchor={[xshift=0.38ex]}] 
	.\end{tikzcd}
	\end{equation*}
	Then, as seen in \cref{CrystalLocalPB}, for a lifting $G_U$ 
	of $\left.G_0\right|_{U_0}$ to $U$, we have
	\begin{equation*}
		\overline{f}^* \left( E(G_U) \right) =
		E(G_V) = \mathbb{E} \left( f^* (G_0) \right)_{V_0 \hookrightarrow V}
	.\end{equation*}
	As a consequence $f^* \left( \mathbb{E}(G_0) \right) =
	\mathbb{E}\left( f^*(G_0) \right)$.
	Let's now notice that we write the above as equalities following \cref{rem:specialSheavesIso};
	more properly these equalities should be considered as isomorphisms.
	Then a more precise statement would be that the following diagram
	commutes up to a {\em unique natural equivalence}:
	\begin{equation*}
	\begin{tikzcd}
		\mathsf{BT}'(S_0)
		\arrow[r, "\mathbb{E}", rightarrow] 
		\arrow[d, "f^*"', rightarrow] &
		\left\{ \text{Crystals in } \mathsf{Gr}_{S_0} \right\}
		\arrow[d, "f^*", rightarrow] \\
		\mathsf{BT}'(T_0) \arrow[r, "\mathbb{E}", rightarrow] &
		\left\{ \text{Crystals in } \mathsf{Gr}_{T_0} \right\}
	,\end{tikzcd}
	\end{equation*}
	where by "Crystal in $\mathsf{Gr}_S$" we mean sheaves $\mathscr{F}$ on $\mathsf{Crys}(S)$
	which, for each $\left(U_0 \hookrightarrow U, \gamma\right) \in \mathsf{Crys}(S)$,
	induce a sheaf $\mathscr{F}_{\left(U_0 \hookrightarrow U, \gamma\right)} \in \mathsf{Gr}_S$
	and are special, as in \cref{defn:SpecialQCSheavesCrys}
\end{rem}


\begin{defn}[]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
\item We define the functor $\overline{\mathbb{E}}$, associating to
	any $G_0 \in \mathsf{BT}'(S_0)$ a crystal in $\mathsf{Gr}_{S_0}$
	setting, for any $\left(U_0 \hookrightarrow U, \delta\right) \in \mathsf{Crys}(S_0)$
	\begin{equation*}
		\overline{\mathbb{E}}(G_0)_{\left(U_0 \hookrightarrow U, \delta\right)} \coloneqq
		\overline{\left( \mathbb{E}(G_0)_{\left(U_0 \hookrightarrow U, \delta\right)} \right)}
	.\end{equation*}

\item We define the functor $\mathbb{D}$, associating to
	any $G_0 \in \mathsf{BT}'(S_0)$ a crystal in $\mathsf{Gr}_{S_0}$
	setting, for any $\left(U_0 \hookrightarrow U, \delta\right) \in \mathsf{Crys}(S_0)$
	\begin{equation*}
		\mathbb{D}(G_0)_{\left(U_0 \hookrightarrow U, \delta\right)} \coloneqq
		\mathrm{Lie}
		\left( \overline{\mathbb{E}}(G_0)_{\left(U_0 \hookrightarrow U, \delta\right)} \right)
	.\end{equation*}

\item We define the functor $\mathbb{D}^*$, associating to
	any $G_0 \in \mathsf{BT}'(S_0)$ a crystal in $\mathsf{Gr}_{S_0}$
	setting, for any $\left(U_0 \hookrightarrow U, \delta\right) \in \mathsf{Crys}(S_0)$
	\begin{equation*}
		\mathbb{D}^*(G_0)_{\left(U_0 \hookrightarrow U, \delta\right)} \coloneqq
		\mathrm{Lie}
		\left( \overline{\mathbb{E}}(G_0^D)_{\left(U_0 \hookrightarrow U, \delta\right)} \right)
	.\end{equation*}
	%$\overline{\mathbb{E}}(G_0)_{\left(U_0 \hookrightarrow U, \delta\right)}$, 
	%since it is a formal Lie group by \cref{prop:ExtFLG}, hence a Barsotti-Tate group,
	%for which we previously introduced the notion of duality.
	%tk: I don't rememeber what I had on my mind...
\end{enumerate}
\end{defn}


\begin{rem}[]
	It is clear that all functors, $\mathbb{E}, \overline{\mathbb{E}}$,
	$\mathbb{D}$ and $\mathbb{D}^*$ are additive.
\end{rem}


\begin{rem}[]
	Let's summarise the above constructions.
	Consider $S_0 \hookrightarrow S$ a nilpotent divided power immersion.
	Assume that $G_0 \in \mathsf{BT}(S_0)$ can be lifted to $G \in \mathsf{BT}(S)$.
	Notice that, by \cref{rem:pDivDualityBaseChange}, $G^D$ is a lift of $G_0^D$.
	Then, up to canonical isomorphism, we have
\begin{enumerate}
	\item $\mathbb{E}(G_0)_{S_0 \hookrightarrow S} = E(G)$,
	\item $\overline{\mathbb{E}}(G_0)_{S_0 \hookrightarrow S} = \overline{E(G)}$,
	\item $\mathbb{D}(G_0)_{S_0 \hookrightarrow S} = 
		\mathrm{Lie}(E(G))$,
	\item $\mathbb{D}^*(G_0)_{S_0 \hookrightarrow S} = \mathrm{Lie}(E(G^D))$.
\end{enumerate}
\end{rem}



\subsection{Grothendieck-Messing deformation theory}


\begin{ntt}
	Let $S$ be a scheme on which $p$ locally nilpotent, $\mathcal{I}$
	be a quasi-coherent ideal of $\mathcal{O}_{ S }$ endowed with locally nilpotent
	divided powers.
	Let $S_0 \coloneqq \mathbb{V}(\mathcal{I})$,
	so that $S_0 \hookrightarrow S$ is an object of the crystalline site of $S_0$.
	Let's introduce the notation $\mathsf{BT}'(S_0)$ to denote the full subcategory of
	$\mathsf{BT}(S_0)$ consisting of those $G_0$s which locally (in
	the Zariski topology) can be lifted to an element $G \in \mathsf{BT}(S)$.
\end{ntt} 


\begin{rem}[]
	Notice that we used the same notation as in \cref{defn:LILBTG}, but with
	a different meaning.
	In fact in this section we will be concerned more with the values crystals
	assume on specific objects of $\mathsf{Crys}(S_0)$, like $S_0 \hookrightarrow S$,
	rather than on the crystals themselves.

	It is worth ending this remark quoting \cref{rem:LocallyLiftableBTG},
	which states that this assumption is actually not restrictive.
\end{rem}


\begin{ntt}[]\label{CrystalAssociatedZarSheafS}
	Since, as remarked above, we are mainly interested in the values of
	crystals on a specific object of $\mathsf{Crys}(S_0)$, given
	by the closed immersion $S_0 \hookrightarrow S$, we introduce the following notation.
	Let $G_0 \in \mathsf{BT}'(S_0)$ and $\mathscr{F}$ a crystal on $\mathsf{Crys}(S)$,
	we denote by $\mathscr{F}_S$ the Zariki sheaf
	$\mathscr{F}_{\left(S_0 \hookrightarrow S, \mathcal{I}\right)}$.
	In particular, for the crystals defined in the previous section, we have
\begin{enumerate}
	\item $\mathbb{E}(G_0)_S \coloneqq \mathbb{E}(G_0)_{S_0 \hookrightarrow S} = E(G)$,
	\item $\overline{\mathbb{E}}(G_0)_S \coloneqq \overline{\mathbb{E}}(G_0)_{S_0 \hookrightarrow S} = 
		\overline{E(G)}$,
	\item $\mathbb{D}(G_0)_S \coloneqq \mathbb{D}(G_0)_{S_0 \hookrightarrow S} = 
		\mathrm{Lie}(E(G))$.
	\item $\mathbb{D}^*(G_0)_S \coloneqq \mathbb{D}^*(G_0)_{S_0 \hookrightarrow S} = 
		\mathrm{Lie}(E(G^D))$.
\end{enumerate}
\end{ntt}


\begin{defn}[Admissible filtration]
	Let $G_0 \in \mathsf{BT}(S_0)$.
	A filtration $\mathrm{Fil}^1 \subset \mathbb{D}(G_0)_S$ is said to be
	{\em admissible} iff $\mathrm{Fil}^1$ is a locally-free vector subgroup
	with locally free quotient which, on $S_0$, reduces to
	(the morphisms of sheaves on $S_0$ associated to)
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\underline{V}(G_0) \arrow[r, "", hookrightarrow] &
		\underline{\mathrm{Lie}}(E(G_0))
	.\end{tikzcd}
	\end{equation*} 
\end{defn}


\begin{defn}[]
	Let's fix $S_0 \hookrightarrow S$ as before.
	We define the category $\mathsf{BF}(S_0)$ whose objects
	are pairs $(G_0, \mathrm{Fil}^1)$, where $G_0 \in \mathsf{BT}(S_0)$
	and $\mathrm{Fil}^1$ is an {\em admissible} filtration on
	$\mathbb{D}(G_0)_S$ and whose morphisms are defined to be
	pairs $(u_0, \xi)$, where $u_0\colon G_0 \to H_0$
	and $\xi$ is a morphism of filtered objects, i.e. a commutative diagram
	\begin{equation*}
	\begin{tikzcd}
		\mathrm{Fil}^1 \arrow[d, "\xi"', rightarrow] 
		\arrow[r, "", hookrightarrow] &
		\mathbb{D}(G_0)_S 
		\arrow[d, "\mathbb{D}(u_0)_S", rightarrow] \\
		\mathrm{Fil}^1 \arrow[r, "", hookrightarrow] &
		\mathbb{D}(H_0)_S
	\end{tikzcd}
	\end{equation*}
	which, on $S_0$, reduces to
	\begin{equation*}
	\begin{tikzcd}
		\underline{V}(G_0) \arrow[r, "", hookrightarrow] 
		\arrow[d, "\underline{V}(u_0)_{S_0}"', rightarrow] &
		\underline{\mathrm{Lie}}(E(G_0))
		\arrow[d, "\underline{\mathrm{Lie}}(E(u_0))", rightarrow] \\
		\underline{V}(H_0) \arrow[r, "", hookrightarrow] &
		\underline{\mathrm{Lie}}(E(H_0))
	\end{tikzcd}
	\end{equation*}
	(or, more precisely, to the associated Zariski sheaves on $S_0$).
\end{defn}


\noindent
This definition allows to state the following theorem:
\begin{thm}[{\cite[Chapter V, theorem 1.6]{Messing}}]\label{thm:EquivCatBTS}
	Let $S \hookrightarrow S_0$ as before.
	The following functor defines an equivalence of categories
	\begin{equation*}
	\begin{tikzcd}[row sep = 0ex
		,/tikz/column 1/.append style={anchor=base east}
		,/tikz/column 2/.append style={anchor=base west}]
		\mathsf{BT}(S) \arrow[r, "", rightarrow] &
		\mathsf{BF}(S_0) \\
		G \arrow[r, "", mapsto] & 
		\left(G_0, \underline{V}(G) \hookrightarrow \underline{\mathrm{Lie}}(E(G))\right)
	,\end{tikzcd}
	\end{equation*} 
	where we denoted by $G_0$ the restriction of $G$ to $S_0$
	and we recall that $\mathbb{D}(G_0)_S = \mathrm{Lie}(E(G))$.
\end{thm}


\begin{rem}[]\leavevmode\vspace{-.2\baselineskip}
\begin{enumerate}
	\item Let $G_0$ be $\mathsf{BT}'(S_0)$.
		We define a Zariski sheaf of sets on $S$, denoted by $\mathscr{L}$,
		as follows.
		Let $U \subset S$ be an affine open subscheme of $S$.
		We define $\Gamma(U,\mathscr{L})$ to be the set of all linearly compatible prolongations,
		as in \cref{defn:LinCompProlong}, of
		\begin{equation*}
		\begin{tikzcd}[row sep = 0ex
			,/tikz/column 1/.append style={anchor=base east}
			,/tikz/column 2/.append style={anchor=base west}]
			\left.\underline{V}(G_0)\right|_{U_0} \arrow[r, "", hookrightarrow] &
			\left.E(G_0)\right|_{U_0}
		\end{tikzcd}
		\end{equation*} 
		to a vector subgroup $V' \hookrightarrow \left.\mathbb{E}(G_0)_S\right|_{U}$
		(more precisely the corresponding morphism between the associated
		fppf sheaves, as in \cref{defn:fppfSheafAssociatedtoMod}).
		Clearly this defines a sheaf on the affine open subsets of $S$.
		Since affine open subschemes form a basis for the topology of $S$, the definition
		of $\mathscr{L}$ can be extended to a sheaf on $S$.

	\item By construction of $\mathbb{E}(G_0)_S$ we can construct a canonical
		section $\Theta \in \Gamma(S, \mathscr{L})$.
		By sheaf properties it is enough to define it on sufficiently small
		affine open subschemes $U$ of $S$ and then check compatibility of all
		these sections.
		In particular we assume that $U$ is affine and $p$ is nilpotent on $U$.
		Then, we define $\left.\Theta\right|_{ U }$ to be the equivalence class
		of $\underline{V}(G)$, where $G$ is any lifting of $\left.G_0\right|_{ U_0 }$
		to $U$.
		In order to check compatibility we pick $U_1$, $U_2$, $G_1$ and $G_2$
		as above and $V \subset U_1 \cap U_2$ affine
		with $p$ nilpotent on it.
		Then we require that the restriction to $V$ of the two liftings,
		which we still denote by $G_1$ and $G_2$, lie in the same equivalence class.
		Here we can apply \cref{prop:MorUnivExts} and obtain the following
		square
		\begin{equation*}
		\begin{tikzcd}
			\underline{V}(G_1) \arrow[r, "j", hookrightarrow] 
			\arrow[d, "w", rightarrow] &
			E(G_1) \arrow[d, "v", rightarrow] \\
			\underline{V}(G_1) \arrow[r, "i", hookrightarrow] &
			E(G_2)
		,\end{tikzcd}
		\end{equation*}
		where $i \circ w - v \circ j$ is an exponential.
		Since $\left.\mathbb{E}(G_0)_S\right|_{ V } = E(G_2)$,
		this is exactly the requirement of \cref{defn:LinCompProlong} 
		to state that the two liftings lie in the same equivalence class.

	\item If $G$ is a global lifting of $G_0$, then we have the canonical isomorphism
		$E(G) \simeq \mathbb{E}(G_0)_S$.
		Hence $\underline{V}(G)$ gives an element $\Theta \in \Gamma(S,\mathscr{L})$,
		i.e. a distinguished vector subgroup in the linear equivalence
		class of prolongations of $\underline{V}(G_0)$.

	\item Notice that, by \cref{prop:equivClassFiltration}, the datum of 
		$V \subset \mathbb{E}(G_0)_S$ which belongs to $\Theta$ is
		equivalent to the datum of an {\em admissible} filtration
		$\mathrm{Fil}^1 \hookrightarrow \mathbb{D}(G_0)_S$.
		In particular the knowledge of the map
		$\underline{V}(G) \hookrightarrow \mathbb{E}(G_0)_S$, for $G$ a global
		lifting of $G_0$, is equivalent to the knowledge of
		$\underline{V}(G) \hookrightarrow \mathbb{D}(G_0)_S$.
		Finally, from the definition of universal extension
		and of the crystal $\mathbb{E}(G_0)$, we can reconstruct 
		\begin{equation*}
			G \simeq \mathbb{E}(G_0)_S/\underline{V}(G)
		.\end{equation*}
		Essentially the above, modulo checking that the quotient defines
		a Barsotti-Tate group (verification which is carried out in
		\cite[Chapter V, theorem 1.6]{Messing}), states that from 
		the datum of an admissible filtration of $\mathbb{D}(G_0)_S$
		one can recover the global lifting $G$ of $G_0$.
		This is indeed the main idea used to construct the quasi-inverse
		to the functor of \cref{thm:EquivCatBTS}.
\end{enumerate}
\end{rem}
